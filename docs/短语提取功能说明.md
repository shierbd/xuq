# 短语提取功能说明

## 功能概述

在Phase 0关键词扩展与分词工具中，新增了**短语提取（N-gram）**功能。除了传统的单词分词，现在还可以提取高频短语组合，帮助您发现更有意义的关键词模式。

## 为什么需要短语提取？

单词分词虽然能够统计词频，但忽略了词与词之间的组合关系。例如：

- **"best free"** - 表达特定的用户需求（既要好又要免费）
- **"how to"** - 典型的教程类搜索意图
- **"running shoes"** - 完整的产品类别
- **"for windows"** - 平台限定词组

这些短语比单个词更能准确反映用户的真实搜索意图和需求。

## 使用方法

### 1. 启用短语提取

在Phase 0的分词配置区域，勾选**"提取短语"**复选框：

```
✓ 提取短语
  提取高频短语组合（如 'best free', 'how to' 等）
```

### 2. 配置提取参数

启用后，会显示配置选项：

- **短语最小频次**：数值输入，默认为3
  - 只保留出现次数 >= 此值的短语
  - 过滤掉低频、偶然出现的组合
  - 这是合理的噪声过滤阈值

**设计说明**：

系统采用**数据驱动的方式**，会自动提取所有2-6词的短语组合。您无需在提取阶段限制短语长度，因为：
- 您无法预先知道数据中会出现什么样的模式
- 数据中可能存在2词、3词、4词、5词甚至6词的高频短语
- 正确的做法是：**提取时发现所有模式，筛选时选择关注的长度**

### 3. 查看结果

点击"🚀 开始分词"后，结果会显示在两个标签页中：

#### 📝 单词标签页
- 显示单词分词结果（与原有功能相同）
- 包含词频、词性、翻译等信息
- 支持筛选、排序、导出

#### 🔗 短语标签页
- 显示提取的高频短语
- 列包含：短语、频次、词数
- 统计信息：短语总数、平均频次、最高频次
- 支持按频次和词数筛选
- 可导出CSV格式

### 4. 筛选和分析

短语标签页提供以下筛选选项：

- **短语最小频次**：动态调整显示的短语频次阈值
- **短语长度筛选**：选择显示2词、3词、4词、5词或6词短语
  - 这是**显示阶段的筛选**，不影响提取
  - 可以根据实际数据灵活选择感兴趣的长度
  - 例如：先看2词短语找核心搭配，再看3-4词短语找完整表达
- **按词数分组显示**：Top 20短语按词数分组，便于分析

### 5. 导出短语

- **下载短语CSV**：导出所有符合条件的短语到CSV文件
- **复制短语内容**：复制到剪贴板，方便粘贴到其他工具

## 应用场景

### 1. 发现用户意图模式

通过高频短语，快速识别用户的常见搜索模式：

```
best free (150次) → 用户关注性价比
how to (120次) → 教程需求
for windows (80次) → 平台特定需求
top rated (75次) → 质量关注
```

### 2. 扩展关键词灵感

短语可以作为关键词扩展的灵感来源：

- 看到 "best free" 高频出现 → 可以搜索 "best free [product]"
- 看到 "how to" 高频 → 可以创建 "how to [action]" 类内容

### 3. 内容创作方向

根据短语频次，决定内容创作的优先级：

```
"how to make money online" (50次) → 高优先级话题
"create website free" (45次) → 中优先级话题
"affordable vpn service" (30次) → 考虑创作
```

### 4. 需求验证

验证您的产品或内容假设：

- 如果 "free trial" 频次很高 → 用户重视试用
- 如果 "step by step guide" 频次高 → 需要详细教程
- 如果 "vs comparison" 频次高 → 需要对比内容

## 技术说明

### N-gram算法

短语提取使用N-gram算法，采用数据驱动的方式：

1. **分词**：将关键词短语按空格和连字符分割
2. **过滤**：移除停用词、单字母词、非字母词
3. **组合**：生成2-gram、3-gram、...、6-gram组合（自动发现所有模式）
4. **统计**：计算每个短语的出现频次
5. **筛选**：保留频次 >= 阈值的短语（移除低频噪声）

**关键设计理念**：
- 提取阶段：从数据中发现所有可能的短语模式（2-6词）
- 显示阶段：用户根据实际情况筛选感兴趣的长度
- 这种数据驱动的方式确保不会错过任何有价值的模式

### 示例

输入短语：`"best running shoes"`

经过处理后：
- 单词：`["best", "running", "shoes"]`
- 2-grams：`["best running", "running shoes"]`
- 3-grams：`["best running shoes"]`

### 停用词处理

短语提取会自动排除停用词，确保提取的短语有意义：

- ❌ "of the" - 无意义的停用词组合
- ✓ "best free" - 有意义的用户需求
- ✓ "how to" - 典型的搜索模式（即使包含"to"）

## 性能优化

- **批量处理**：一次性处理所有关键词，高效统计
- **内存优化**：使用Counter数据结构，节省内存
- **阈值过滤**：提前过滤低频短语，减少存储开销

## 最佳实践

### 1. 参数设置建议

根据数据量调整参数：

| 数据量 | 最小频次 | 说明 |
|--------|----------|------|
| <1000条 | 2 | 保留更多短语，发现潜在模式 |
| 1000-10000条 | 3-5 | 平衡覆盖率和精确度 |
| >10000条 | 5-10 | 关注高频、高质量短语 |

**显示筛选建议**：
- 初次查看：先选择2词和3词短语，这些最常见
- 深入分析：逐步增加4词、5词、6词短语，发现更长的模式
- 按需调整：根据实际数据中的短语分布灵活选择

### 2. 分析流程建议

```
1. 先看2词短语 → 发现核心搭配
2. 再看3词短语 → 发现完整表达
3. 筛选高频短语 → 确定重点方向
4. 结合单词分词 → 完整理解需求
```

### 3. 导出和使用

```
1. 导出高频短语到CSV
2. 使用短语在Google Autocomplete/相关搜索中扩展
3. 导入扩展结果到数据库
4. 重复Phase 0流程，迭代优化
```

## 常见问题

### Q: 为什么有些明显的短语没有被提取？

A: 可能的原因：
1. **频次不够**：低于设置的最小频次阈值
2. **包含停用词**：短语中有停用词被过滤
3. **显示筛选**：在短语长度筛选中未选择该长度

解决方法：
- 降低最小频次阈值
- 调整停用词列表
- 在显示筛选中选择更多的短语长度（2-6词）

### Q: 短语提取会影响性能吗？

A: 有一定影响，但经过优化后可以接受：
- 1000条关键词：< 1秒
- 10000条关键词：1-3秒
- 100000条关键词：10-30秒

### Q: 可以将短语添加为词根吗？

A: 目前短语只能导出查看，不能直接添加为词根。但您可以：
1. 导出高频短语
2. 使用短语扩展更多关键词
3. 将扩展的关键词导入数据库
4. 再次分词，提取新的单词作为词根

### Q: 短语提取与词根追溯的关系？

A: 短语提取是独立功能，不追溯来源词根。如果需要：
- 单词层面的词根追溯 → 查看"单词"标签页的"来源词根"列
- 短语层面的分析 → 需要手动查看原始关键词

## 未来规划

- [ ] 短语也支持词根追溯
- [ ] 短语翻译功能
- [ ] 短语与需求卡片关联
- [ ] 短语的Token分类（intent/action/object）
- [ ] 短语也可添加为词根（作为多词词根）

## 反馈与建议

如果您有任何关于短语提取功能的建议或问题，欢迎反馈！
