# 实验 2: EOM vs Leaf 测试结果

**实验日期**: 2026-02-02
**实验目的**: 测试 Stage 1 使用 eom vs leaf 对聚类结果的影响

---

## 实验设置

### 方法
- **之前**: 所有阶段使用 cluster_selection_method='leaf'
- **现在**: Stage 1 使用 'eom'，Stage 2/3 使用 'leaf'

### 参数变化

| 参数 | 之前 (全 leaf) | 现在 (Stage 1 eom) |
|------|---------------|-------------------|
| Stage 1 method | leaf | **eom** ✅ |
| Stage 1 epsilon | 0.3 | **0.0** ✅ |
| Stage 2 method | leaf | leaf |
| Stage 3 method | leaf | leaf |

### 其他参数
- 三阶段聚类
- L2 归一化（cosine-equivalent）
- stage1_min_size: 10
- stage2_min_size: 5
- stage3_min_size: 3

---

## 实验结果

### 总体对比

| 指标 | Leaf (全阶段) | EOM (Stage 1) | 变化 |
|------|--------------|---------------|------|
| 总商品数 | 15,792 | 15,792 | - |
| 生成簇数 | 1,416 | 1,392 | **-24 (-1.7%)** ✅ |
| 噪音点数 | 4,645 | 4,473 | **-172 (-3.7%)** ✅ |
| 噪音比例 | 29.41% | 28.32% | **-1.09%** ✅ |

### 各阶段对比

| 阶段 | Leaf 簇数 | EOM 簇数 | 变化 |
|------|----------|---------|------|
| Stage 1 (主要簇) | 224 | 215 | **-9 (-4.0%)** ✅ |
| Stage 2 (次级簇) | 462 | 458 | -4 (-0.9%) |
| Stage 3 (微型簇) | 730 | 719 | **-11 (-1.5%)** ✅ |

### Stage 1 详细对比

| 指标 | Leaf | EOM | 变化 |
|------|------|-----|------|
| 簇数量 | 224 | 215 | -9 |
| 噪音点 | 11,204 | 10,970 | **-234** ✅ |
| 噪音比例 | 70.95% | 69.47% | -1.48% |

---

## 结果分析

### 1. 改善效果明显但有限

**关键发现**: EOM 对 Stage 1 有改善，但**效果不如预期**

**改善点**:
- ✅ 总簇数减少 24 个（1.7%）
- ✅ 噪音点减少 172 个（3.7%）
- ✅ Stage 1 簇数减少 9 个（更稳定）
- ✅ 微型簇减少 11 个

**但是**:
- ⚠️ 改善幅度较小（只有 1-4%）
- ⚠️ 微型簇仍然很多（719 个）
- ⚠️ 没有达到 GPT 预期的"显著减少微簇"

### 2. 为什么改善有限？

可能的原因:

#### 原因 1: Stage 2/3 仍在制造微簇
- Stage 1 用 eom 减少了 9 个簇
- 但 Stage 2/3 仍用 leaf，继续制造微簇
- **结论**: 需要重新设计 Stage 2/3 的策略

#### 原因 2: 数据本身的分散性
- 商品名称语义分布可能本身就很分散
- 即使用 eom，也难以形成大簇
- **结论**: 可能需要更激进的预处理（双文本策略）

#### 原因 3: min_cluster_size 仍然太小
- Stage 1: min_size=10 可能还是太小
- Stage 2: min_size=5 太小
- Stage 3: min_size=3 太小
- **结论**: 可能需要提高 min_cluster_size

#### 原因 4: 属性词污染
- 颜色/材质/风格词仍在影响聚类
- 导致按属性分组，而非需求主题
- **结论**: 必须实现双文本策略

### 3. 与 GPT 预期的对比

**GPT 预期**:
- Stage 1 簇数量显著减少
- 每个簇更大、更稳定
- 微簇总数显著减少
- 簇更容易命名

**实际结果**:
- ⚠️ Stage 1 簇数只减少 4%（9个）
- ⚠️ 微簇总数只减少 1.5%（11个）
- ✅ 噪音略有减少（172个）
- ❓ 簇的可命名性未测试

### 4. 关键洞察

> **EOM 有帮助，但不是银弹**。真正的问题在于：
> 1. Stage 2/3 的策略（仍在制造微簇）
> 2. 预处理策略（属性词污染）
> 3. 参数设置（min_cluster_size 太小）

---

## 对比三个实验的累积效果

| 实验 | 改动 | 簇数 | 噪音 | 效果 |
|------|------|------|------|------|
| 基线 | euclidean, leaf | 1,412 | 4,620 (29.26%) | - |
| 实验 1 | + L2 归一化 | 1,416 (+4) | 4,645 (+25) | ❌ 无改善 |
| 实验 2 | + Stage 1 eom | 1,392 (-24) | 4,473 (-172) | ✅ 小幅改善 |

**累积效果**:
- 从基线到实验 2: 簇数 -20 (-1.4%)，噪音 -147 (-3.2%)
- **结论**: 两个实验的累积效果仍然有限

---

## 结论

### 主要结论

> **EOM 是正确方向，但单独使用效果有限**。需要配合其他优化才能达到预期效果。

### 验证的假设

1. ✅ **EOM 比 leaf 更保守** - 验证成功
   - Stage 1 簇数减少 4%
   - 噪音点减少 234 个

2. ⚠️ **EOM 能显著减少微簇** - 部分验证
   - 微簇只减少 11 个（1.5%）
   - 效果不如预期

3. ❌ **EOM 能大幅提升聚类质量** - 未验证
   - 改善幅度较小
   - 需要配合其他优化

### 未验证的假设

1. ❓ **簇的可命名性是否提升** - 需要人工评估
2. ❓ **簇的语义一致性是否提升** - 需要质量评估
3. ❓ **是否更适合需求挖掘** - 需要实际使用验证

---

## 下一步行动

### 必须做（P0）

1. **✅ 实验 3: 双文本策略**
   - 去除颜色/材质/风格词
   - 这是 GPT 认为的第四大问题
   - **预期**: 这可能是最关键的改进

2. **✅ 重新设计 Stage 2/3**
   - Stage 2: 改为归并逻辑（不再聚类）
   - Stage 3: 添加质量门控
   - **预期**: 大幅减少微簇

### 可以尝试（P1）

3. **提高 min_cluster_size**
   - Stage 1: 10 → 15 或 20
   - Stage 2: 5 → 8
   - Stage 3: 3 → 5
   - **预期**: 减少小簇

4. **调整 Stage 2/3 的 method**
   - Stage 2/3 也改用 eom
   - **预期**: 进一步减少微簇

---

## 关键数据

### Stage 1 噪音点减少

```
Leaf:  11,204 噪音点 (70.95%)
EOM:   10,970 噪音点 (69.47%)
减少:     234 噪音点 (-1.48%)
```

这 234 个商品被成功聚类到主要簇中，说明 EOM 确实更保守、更稳定。

### 微型簇仍然很多

```
Stage 3 微型簇: 719 个
占总簇数: 51.6%
```

超过一半的簇是微型簇（3-4个商品），这些簇在需求挖掘中通常不可命名、不可行动。

---

## 实验数据

### 完整输出

```
Total products: 15792
Clusters: 1392
  - Primary clusters (>=10): 215
  - Secondary clusters (5-9): 458
  - Micro clusters (3-4): 719
Noise points: 4473
Noise ratio: 28.32%
```

### Stage 1 详细数据

```
Method: eom
Epsilon: 0.0
Min cluster size: 10
Min samples: 5

Results:
  Clusters: 215
  Noise: 10,970 (69.47%)
```

---

## 下一个实验

**实验 3**: 双文本策略（topic_text + full_text）

**假设**: 去除颜色/材质/风格词后，聚类会按需求主题分组，而非属性分组，从而大幅提升聚类质量。

**这可能是最关键的改进** - 因为它直接解决了"按属性聚类 vs 按需求主题聚类"的根本问题。

---

**创建者**: Claude Sonnet 4.5
**实验时间**: 2026-02-02
