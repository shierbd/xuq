# 步骤A2使用说明（GUI版本）

## 🎯 新功能：弹窗选择路径

现在运行 `step_A2_merge_csv.py` 时，会提供3种方式选择输入文件夹：

### **方式1：使用弹窗选择（推荐）** ⭐

```bash
python step_A2_merge_csv.py
```

**流程**：

1. **选择方式**
   ```
   选择输入文件夹方式:
     1. 使用弹窗选择文件夹（推荐）
     2. 使用配置文件中的路径
     3. 手动输入路径

   请选择 (1/2/3，直接回车默认选1):
   ```
   直接回车或输入 `1`

2. **弹窗选择文件夹**
   - 会弹出一个文件夹选择对话框
   - 默认位置是配置文件中的路径（`C:\Users\32941\Downloads\合并`）
   - 浏览并选择包含CSV文件的文件夹

3. **确认选择**
   - 程序会检查文件夹中是否有CSV文件
   - 如果找到文件，会弹出确认对话框
   - 显示找到的文件数量

4. **开始合并**
   - 点击"是"开始合并
   - 点击"否"重新选择文件夹

5. **完成提示**
   - 执行完成后会弹出成功提示框
   - 显示合并统计信息

---

### **方式2：使用配置文件路径**

```bash
python step_A2_merge_csv.py
# 输入: 2
```

直接使用 `config.py` 中的 `RAW_DATA_DIR` 路径，无需弹窗。

---

### **方式3：手动输入路径**

```bash
python step_A2_merge_csv.py
# 输入: 3
# 然后输入路径: C:\Users\32941\Downloads\合并
```

在命令行手动输入文件夹路径。

---

## 🎨 界面预览

### 1. 文件夹选择对话框
```
┌─────────────────────────────────────┐
│ 选择包含CSV文件的文件夹              │
├─────────────────────────────────────┤
│                                     │
│  [文件夹浏览树]                      │
│                                     │
│  C:\Users\32941\Downloads\合并      │
│                                     │
│         [取消]      [选择文件夹]     │
└─────────────────────────────────────┘
```

### 2. 确认对话框
```
┌─────────────────────────────────────┐
│            确认文件夹                │
├─────────────────────────────────────┤
│ 已选择文件夹：                       │
│                                     │
│ C:\Users\32941\Downloads\合并       │
│                                     │
│ 找到 47 个CSV文件                    │
│                                     │
│ 是否使用此文件夹？                   │
│                                     │
│ 点击 '是' 继续                       │
│ 点击 '否' 重新选择                   │
│                                     │
│         [否]        [是]             │
└─────────────────────────────────────┘
```

### 3. 成功提示
```
┌─────────────────────────────────────┐
│            执行成功                  │
├─────────────────────────────────────┤
│ CSV文件合并完成！                    │
│                                     │
│ 合并文件数: 46                       │
│ 总行数: 6,565                        │
│                                     │
│ 输出文件:                            │
│ D:\xiangmu\词根聚类需求挖掘\data\   │
│ merged_keywords_all.csv             │
│                                     │
│              [确定]                  │
└─────────────────────────────────────┘
```

---

## 🔍 错误处理

### 如果选择的文件夹中没有CSV文件：

```
┌─────────────────────────────────────┐
│         未找到CSV文件                │
├─────────────────────────────────────┤
│ 在文件夹中未找到匹配的CSV文件！      │
│                                     │
│ 匹配模式: *_broad-match_*.csv       │
│                                     │
│ 是否重新选择文件夹？                 │
│                                     │
│         [否]        [是]             │
└─────────────────────────────────────┘
```

---

## ⚙️ 技术说明

### 依赖库
- `tkinter` - Python标准库，无需额外安装
- 自动隐藏主窗口，只显示对话框
- 对话框始终置顶（`topmost=True`）

### 文件匹配模式
默认匹配模式：`*_broad-match_*.csv`

可在 `config.py` 中修改：
```python
A2_CONFIG = {
    "file_pattern": "*_broad-match_*.csv",  # 修改这里
}
```

---

## 💡 使用建议

1. **推荐使用方式1（弹窗选择）**
   - 直观、方便
   - 可以快速切换不同文件夹
   - 有错误提示和确认机制

2. **批量处理时使用方式2**
   - 如果每次都处理同一个文件夹
   - 在 `config.py` 中设置好路径
   - 运行时选择方式2，无需交互

3. **脚本自动化时使用方式2**
   - 配合其他脚本使用
   - 无需GUI交互

---

## 📝 示例：完整流程

```bash
# 1. 运行程序
python step_A2_merge_csv.py

# 2. 选择方式（直接回车）
请选择 (1/2/3，直接回车默认选1): [回车]

# 3. 弹窗选择文件夹
正在打开文件夹选择对话框...
[GUI对话框打开]

# 4. 选择后确认
已选择文件夹: C:\Users\32941\Downloads\合并
找到 47 个CSV文件
[GUI确认对话框]

# 5. 开始处理
配置信息:
  输入文件夹: C:\Users\32941\Downloads\合并
  输出文件名: merged_keywords_all.csv
  文件模式: *_broad-match_*.csv

[1/47] 正在读取: action_broad-match_us_2025-12-12.csv
   行数: 49
[2/47] 正在读取: advisor_broad-match_us_2025-12-11.csv
   行数: 4
...

# 6. 完成
==================================================
              合并完成
==================================================
总文件数: 47
成功合并: 47
总行数: 6,565

[GUI成功提示框]
```

---

## 🎉 开始使用

现在就运行试试吧！

```bash
python step_A2_merge_csv.py
```
