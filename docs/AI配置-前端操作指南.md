# AI配置管理 - 前端操作指南

**创建日期**: 2026-01-30
**版本**: v1.0

---

## 📋 前提条件

### 1. 确保服务正在运行

**后端服务**（端口 8001）:
```bash
# 在项目根目录运行
python -m uvicorn backend.main:app --reload --port 8001
```

**前端服务**（端口 3000）:
```bash
# 在 frontend 目录运行
cd frontend
npm run dev
```

### 2. 配置API密钥

在项目根目录的 `.env` 文件中添加API密钥：

```bash
# 至少配置一个提供商
DEEPSEEK_API_KEY=sk-xxx
CLAUDE_API_KEY=sk-ant-xxx
OPENAI_API_KEY=sk-xxx
```

### 3. 运行配置脚本

```bash
python scripts/setup_ai_config.py
```

---

## 🚀 访问AI配置页面

### 方式1：通过菜单导航

1. 打开浏览器访问：http://localhost:3000
2. 在左侧菜单找到 **"AI配置管理"** 模块
3. 点击 **"AI配置管理"** 进入配置页面

### 方式2：直接访问

直接在浏览器中访问：http://localhost:3000/ai-config

---

## 📊 页面功能说明

AI配置管理页面包含3个标签页：

### 1️⃣ AI提供商管理

**功能**:
- 查看所有AI提供商列表
- 添加新的AI提供商
- 编辑提供商配置（API密钥、端点等）
- 启用/禁用提供商
- 测试提供商连接
- 删除提供商

**操作步骤**:

#### 添加提供商
1. 点击 **"添加提供商"** 按钮
2. 填写表单：
   - **提供商名称**: 如 "Claude", "DeepSeek"
   - **API密钥**: 您的API密钥
   - **API端点**: 如 `https://api.anthropic.com`
   - **超时时间**: 默认30秒
   - **最大重试次数**: 默认3次
3. 点击 **"确定"** 保存

#### 编辑提供商
1. 在提供商列表中找到要编辑的提供商
2. 点击 **"编辑"** 按钮
3. 修改配置信息
4. 点击 **"确定"** 保存

#### 测试连接
1. 在提供商列表中找到要测试的提供商
2. 点击 **"测试连接"** 按钮
3. 系统会发送测试请求并显示结果

#### 启用/禁用
1. 在提供商列表中找到要切换的提供商
2. 点击 **"启用"** 或 **"禁用"** 按钮
3. 禁用的提供商不会被使用

---

### 2️⃣ AI模型管理

**功能**:
- 查看所有AI模型列表
- 添加新的AI模型
- 编辑模型配置（温度、token数等）
- 设置默认模型
- 启用/禁用模型
- 删除模型

**操作步骤**:

#### 添加模型
1. 点击 **"添加模型"** 按钮
2. 填写表单：
   - **选择提供商**: 从下拉列表选择
   - **模型名称**: 如 "gpt-4o", "claude-3-5-sonnet-20241022"
   - **模型版本**: 如 "latest", "20241022"
   - **温度参数**: 0.0-1.0，默认0.7
   - **最大Token数**: 如 4096, 8192
   - **输入价格**: $/1M tokens
   - **输出价格**: $/1M tokens
   - **能力标签**: 如 "text-generation", "json-output"
   - **是否默认**: 勾选后成为该提供商的默认模型
3. 点击 **"确定"** 保存

#### 编辑模型
1. 在模型列表中找到要编辑的模型
2. 点击 **"编辑"** 按钮
3. 修改配置信息
4. 点击 **"确定"** 保存

#### 设置默认模型
1. 在模型列表中找到要设为默认的模型
2. 点击 **"设为默认"** 按钮
3. 该模型会成为其提供商的默认模型

#### 筛选模型
- **按提供商筛选**: 选择特定提供商查看其模型
- **按状态筛选**: 查看启用或禁用的模型
- **按默认状态筛选**: 查看默认模型

---

### 3️⃣ 使用场景管理

**功能**:
- 查看所有使用场景列表
- 添加新的使用场景
- 编辑场景配置（主模型、回退模型等）
- 查看场景详情（包含模型信息）
- 启用/禁用场景
- 删除场景

**操作步骤**:

#### 添加场景
1. 点击 **"添加场景"** 按钮
2. 填写表单：
   - **场景名称**: 如 "类别名称生成", "需求分析"
   - **场景描述**: 详细说明场景用途
   - **主模型**: 从下拉列表选择（优先使用）
   - **回退模型**: 从下拉列表选择（主模型失败时使用）
   - **自定义参数**: JSON格式，如：
     ```json
     {
       "temperature": 0.3,
       "max_tokens": 50
     }
     ```
3. 点击 **"确定"** 保存

#### 编辑场景
1. 在场景列表中找到要编辑的场景
2. 点击 **"编辑"** 按钮
3. 修改配置信息
4. 点击 **"确定"** 保存

#### 查看场景详情
1. 在场景列表中找到要查看的场景
2. 点击 **"查看详情"** 按钮
3. 可以看到：
   - 场景基本信息
   - 主模型详细信息（名称、版本、价格等）
   - 回退模型详细信息
   - 自定义参数

---

## 💡 使用建议

### 1. 推荐配置顺序

1. **先添加提供商** → 配置API密钥
2. **再添加模型** → 为每个提供商添加模型
3. **最后创建场景** → 为不同用途配置场景

### 2. 模型选择建议

**日常使用**:
- 主模型：DeepSeek Chat（性价比高）
- 回退模型：Claude Haiku（快速可靠）

**重要任务**:
- 主模型：Claude Sonnet（质量最高）
- 回退模型：GPT-4o（备用方案）

**快速测试**:
- 主模型：Claude Haiku（快速）
- 回退模型：GPT-4o-mini（便宜）

### 3. 场景配置建议

**类别名称生成**:
```json
{
  "temperature": 0.3,
  "max_tokens": 50
}
```
- 低温度保证稳定性
- 少token控制成本

**需求分析**:
```json
{
  "temperature": 0.5,
  "max_tokens": 500
}
```
- 中等温度平衡创造性和准确性
- 较多token支持详细分析

**Top商品深度分析**:
```json
{
  "temperature": 0.7,
  "max_tokens": 1024
}
```
- 较高温度鼓励创造性思考
- 更多token支持深度分析

---

## 🔍 常见问题

### Q1: 页面显示404错误

**原因**: 前端API路径配置错误（已修复）

**解决方案**:
1. 确保使用最新的代码
2. 重启前端开发服务器
3. 清除浏览器缓存

### Q2: 无法连接到后端

**原因**: 后端服务未运行或端口不匹配

**解决方案**:
1. 检查后端服务是否在运行（端口8001）
2. 访问 http://localhost:8001/health 测试后端
3. 检查前端代理配置（vite.config.js）

### Q3: 提供商列表为空

**原因**: 未运行配置脚本

**解决方案**:
1. 配置 `.env` 文件中的API密钥
2. 运行 `python scripts/setup_ai_config.py`
3. 刷新页面

### Q4: 测试连接失败

**原因**: API密钥无效或网络问题

**解决方案**:
1. 检查API密钥是否正确
2. 检查网络连接
3. 检查API端点是否正确
4. 查看后端日志了解详细错误

### Q5: 无法添加模型

**原因**: 提供商未启用或不存在

**解决方案**:
1. 先添加并启用提供商
2. 确保提供商状态为"启用"
3. 刷新页面重试

---

## 📊 界面预览

### AI提供商管理页面
```
┌─────────────────────────────────────────────────────┐
│ AI配置管理                                          │
│ 统一管理AI提供商、模型和使用场景配置                │
├─────────────────────────────────────────────────────┤
│ [AI提供商] [AI模型] [使用场景]                      │
├─────────────────────────────────────────────────────┤
│                                                     │
│ [+ 添加提供商]                    [🔍 搜索]        │
│                                                     │
│ ┌─────────────────────────────────────────────┐   │
│ │ 提供商名称 │ API端点 │ 状态 │ 操作          │   │
│ ├─────────────────────────────────────────────┤   │
│ │ Claude     │ https://api.anthropic.com      │   │
│ │            │ 启用 │ [编辑][测试][禁用][删除]│   │
│ ├─────────────────────────────────────────────┤   │
│ │ DeepSeek   │ https://api.deepseek.com       │   │
│ │            │ 启用 │ [编辑][测试][禁用][删除]│   │
│ └─────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────┘
```

### AI模型管理页面
```
┌─────────────────────────────────────────────────────┐
│ AI配置管理                                          │
│ 统一管理AI提供商、模型和使用场景配置                │
├─────────────────────────────────────────────────────┤
│ [AI提供商] [AI模型] [使用场景]                      │
├─────────────────────────────────────────────────────┤
│                                                     │
│ [+ 添加模型]                                        │
│                                                     │
│ 筛选: [提供商▼] [状态▼] [默认▼]                    │
│                                                     │
│ ┌─────────────────────────────────────────────┐   │
│ │ 模型名称 │ 提供商 │ 价格 │ 状态 │ 操作     │   │
│ ├─────────────────────────────────────────────┤   │
│ │ claude-3-5-sonnet-20241022                  │   │
│ │ Claude │ $3/$15 │ 启用 │ [默认]           │   │
│ │        │        │      │ [编辑][禁用][删除]│   │
│ ├─────────────────────────────────────────────┤   │
│ │ deepseek-chat                               │   │
│ │ DeepSeek │ $0.14/$0.28 │ 启用 │ [默认]    │   │
│ │          │             │      │ [编辑][禁用]│   │
│ └─────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────┘
```

### 使用场景管理页面
```
┌─────────────────────────────────────────────────────┐
│ AI配置管理                                          │
│ 统一管理AI提供商、模型和使用场景配置                │
├─────────────────────────────────────────────────────┤
│ [AI提供商] [AI模型] [使用场景]                      │
├─────────────────────────────────────────────────────┤
│                                                     │
│ [+ 添加场景]                                        │
│                                                     │
│ ┌─────────────────────────────────────────────┐   │
│ │ 场景名称 │ 主模型 │ 回退模型 │ 状态 │ 操作 │   │
│ ├─────────────────────────────────────────────┤   │
│ │ 类别名称生成                                │   │
│ │ deepseek-chat │ claude-3-haiku │ 启用      │   │
│ │ [详情][编辑][禁用][删除]                    │   │
│ ├─────────────────────────────────────────────┤   │
│ │ 需求分析                                    │   │
│ │ deepseek-chat │ claude-3-haiku │ 启用      │   │
│ │ [详情][编辑][禁用][删除]                    │   │
│ └─────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────┘
```

---

## 🎯 快速开始

### 最简单的方式（使用预设配置）

1. **配置API密钥**
   ```bash
   # 编辑 .env 文件
   DEEPSEEK_API_KEY=sk-xxx
   CLAUDE_API_KEY=sk-ant-xxx
   ```

2. **运行配置脚本**
   ```bash
   python scripts/setup_ai_config.py
   ```

3. **访问前端页面**
   - 打开浏览器：http://localhost:3000/ai-config
   - 查看已配置的提供商、模型和场景
   - 开始使用！

---

## 📞 获取帮助

如有问题，请查看：
1. **快速开始指南**: `docs/AI配置快速开始.md`
2. **完成总结**: `docs/AI配置预设-完成总结.md`
3. **迁移计划**: `docs/AI调用迁移计划.md`

---

**祝您使用愉快！** 🎉

*本文档由 Claude Sonnet 4.5 生成*
*最后更新: 2026-01-30*
