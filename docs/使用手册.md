# 需求挖掘系统 v2.0 - 使用手册

## 📖 目录

1. [系统简介](#系统简介)
2. [快速开始](#快速开始)
3. [词根聚类模块](#词根聚类模块)
4. [商品管理模块](#商品管理模块)
5. [数据分析](#数据分析)
6. [常见问题](#常见问题)
7. [最佳实践](#最佳实践)

---

## 系统简介

需求挖掘系统 v2.0 是一个统一的需求挖掘与分析平台，包含两大核心模块：

### 词根聚类模块
- **功能**: 基于语义聚类的需求挖掘
- **数据**: 6,565个关键词，63个需求簇
- **用途**: 发现产品机会方向

### 商品管理模块
- **功能**: Etsy商品数据分析
- **数据**: 345个商品记录
- **用途**: 分析市场供给情况

---

## 快速开始

### 1. 启动系统

**启动后端**:
```bash
cd "D:\xiangmu\词根聚类需求挖掘"
python -m uvicorn backend.main:app --reload --port 8000
```

**启动前端**:
```bash
cd frontend
npm run dev
```

### 2. 访问系统

- **前端界面**: http://localhost:5173
- **后端API**: http://127.0.0.1:8000
- **API文档**: http://127.0.0.1:8000/docs

### 3. 验证系统

```bash
# 检查后端状态
curl http://127.0.0.1:8000/

# 检查关键词数量
curl http://127.0.0.1:8000/api/keywords/count

# 检查商品数量
curl http://127.0.0.1:8000/api/products/count
```

---

## 词根聚类模块

### 核心概念

**种子词 (Seed Word)**:
- 定义: 用于扩展关键词的核心词根
- 示例: "Best", "How-to", "code", "top"
- 数量: 46个种子词

**关键词 (Keyword)**:
- 定义: 从种子词扩展出的短语
- 示例: "best buy coupon code", "how to make pizza"
- 数量: 6,565个关键词

**簇 (Cluster)**:
- 定义: 语义相似的关键词组
- 示例: 簇#42包含502个area code相关关键词
- 数量: 63个有效簇

**噪音点 (Noise)**:
- 定义: 无法归入任何簇的关键词
- 数量: 221个（3.4%）

### 使用场景

#### 场景1: 发现高价值需求方向

**步骤**:
1. 查看簇概览，找出大簇
2. 分析簇的搜索量和种子词
3. 查看簇内的代表性关键词
4. 评估商业价值

**示例**:
```bash
# 1. 获取所有簇概览
curl "http://127.0.0.1:8000/api/keywords/clusters/overview?stage=A&exclude_noise=true"

# 2. 查看簇#39的详情（优惠码簇）
curl "http://127.0.0.1:8000/api/keywords/clusters/39?stage=A"
```

**结果**:
- 簇#39: 306个关键词
- 总搜索量: 3,189,400/月
- 商业价值: 极高（电商、联盟营销）

#### 场景2: 分析特定种子词的表现

**步骤**:
1. 获取种子词列表
2. 查看特定种子词的关键词
3. 分析搜索量分布
4. 识别高价值关键词

**示例**:
```bash
# 1. 获取所有种子词
curl "http://127.0.0.1:8000/api/keywords/seed-words"

# 2. 查看"Best"种子词的关键词
curl "http://127.0.0.1:8000/api/keywords/?seed_word=Best&page_size=50"
```

#### 场景3: 搜索特定主题的关键词

**步骤**:
1. 使用搜索功能
2. 查看搜索结果
3. 分析相关簇
4. 评估机会

**示例**:
```bash
# 搜索"planner"相关关键词
curl "http://127.0.0.1:8000/api/keywords/?search=planner&page_size=20"
```

### 数据洞察

#### Top 5 最有价值的簇

1. **簇#42 - Area Code (502个关键词)**
   - 搜索量: 17,257,200/月
   - 商业价值: 高（本地服务、电信）
   - 建议: 开发本地服务查询工具

2. **簇#39 - 优惠码 (306个关键词)**
   - 搜索量: 3,189,400/月
   - 商业价值: 极高（联盟营销）
   - 建议: 建立优惠码聚合平台

3. **簇#35 - Best产品 (92个关键词)**
   - 搜索量: 859,000/月
   - 商业价值: 高（产品评测）
   - 建议: 创建产品推荐网站

4. **簇#56 - 餐厅旅游 (79个关键词)**
   - 搜索量: 748,300/月
   - 商业价值: 高（本地服务）
   - 建议: 开发本地推荐应用

5. **簇#54 - 美容护发 (77个关键词)**
   - 搜索量: 661,400/月
   - 商业价值: 极高（电商）
   - 建议: 建立美容产品推荐站

#### Top 5 最高产的种子词

1. **code** - 1,191个关键词
   - 总搜索量: 24,341,200/月
   - 覆盖领域: 优惠码、邮编、编程

2. **How-to** - 1,186个关键词
   - 总搜索量: 12,377,300/月
   - 覆盖领域: 教程、指南

3. **Best** - 837个关键词
   - 总搜索量: 8,146,300/月
   - 覆盖领域: 产品推荐、评测

4. **top** - 300个关键词
   - 总搜索量: 2,871,100/月
   - 覆盖领域: 排名、推荐

5. **tester** - 282个关键词
   - 总搜索量: 3,311,000/月
   - 覆盖领域: 测试、检测

---

## 商品管理模块

### 核心概念

**商品 (Product)**:
- 定义: Etsy平台的商品数据
- 数量: 345个商品
- 字段: 名称、评分、评价数、店铺、价格等

**簇ID (Cluster ID)**:
- 定义: 商品所属的需求簇
- 用途: 关联商品与需求方向

### 使用场景

#### 场景1: 分析市场供给

**步骤**:
1. 查看商品总数
2. 按评分筛选高质量商品
3. 分析价格分布
4. 识别热门店铺

**示例**:
```bash
# 1. 获取商品总数
curl "http://127.0.0.1:8000/api/products/count"

# 2. 查看高评分商品
curl "http://127.0.0.1:8000/api/products/?min_rating=4.5&page_size=20"

# 3. 查看特定价格区间的商品
curl "http://127.0.0.1:8000/api/products/?min_price=10&max_price=50"
```

#### 场景2: 搜索特定类型商品

**步骤**:
1. 使用搜索功能
2. 查看搜索结果
3. 分析商品特征
4. 评估竞争情况

**示例**:
```bash
# 搜索"planner"相关商品
curl "http://127.0.0.1:8000/api/products/?search=planner&page_size=20"
```

#### 场景3: 分析店铺表现

**步骤**:
1. 按店铺筛选商品
2. 查看店铺的商品数量
3. 分析评分和评价数
4. 识别成功模式

**示例**:
```bash
# 查看特定店铺的商品
curl "http://127.0.0.1:8000/api/products/?shop_name=DigitalPlannerShop"
```

---

## 数据分析

### 使用数据库查询工具

**启动工具**:
```bash
cd "D:\xiangmu\词根聚类需求挖掘"
python scripts/db_query_tool.py
```

**功能菜单**:
1. 显示所有表
2. 显示表结构
3. 显示数据库统计
4. 显示最大的簇
5. 显示种子词统计
6. 搜索关键词
7. 查看簇详情
8. 导出数据到CSV

### 常用分析任务

#### 任务1: 查看数据库统计

```bash
python scripts/db_query_tool.py
# 选择选项 3
```

**输出示例**:
```
关键词总数: 6,565
已聚类关键词: 6,344 (96.6%)
噪音点数量: 221 (3.4%)
簇数量: 63
种子词数量: 46

商品总数: 345
已聚类商品: 345 (100%)
```

#### 任务2: 查看最大的簇

```bash
python scripts/db_query_tool.py
# 选择选项 4
# 输入显示数量（如10）
```

#### 任务3: 搜索关键词

```bash
python scripts/db_query_tool.py
# 选择选项 6
# 输入搜索词（如"best"）
```

#### 任务4: 查看簇详情

```bash
python scripts/db_query_tool.py
# 选择选项 7
# 输入簇ID（如42）
```

#### 任务5: 导出数据

```bash
python scripts/db_query_tool.py
# 选择选项 8
# 输入表名（keywords或products）
# 输入输出文件名
```

### 使用Python进行自定义分析

**示例1: 分析簇大小分布**:
```python
import sqlite3
import pandas as pd
import matplotlib.pyplot as plt

conn = sqlite3.connect('data/products.db')

# 获取簇大小分布
query = """
SELECT cluster_id_a, COUNT(*) as size
FROM keywords
WHERE cluster_id_a IS NOT NULL AND cluster_id_a != -1
GROUP BY cluster_id_a
ORDER BY size DESC;
"""
df = pd.read_sql_query(query, conn)

# 绘制分布图
plt.figure(figsize=(12, 6))
plt.bar(range(len(df)), df['size'])
plt.xlabel('Cluster Rank')
plt.ylabel('Cluster Size')
plt.title('Cluster Size Distribution')
plt.savefig('cluster_distribution.png')

conn.close()
```

**示例2: 分析搜索量分布**:
```python
import sqlite3
import pandas as pd

conn = sqlite3.connect('data/products.db')

# 获取搜索量统计
query = """
SELECT
    CASE
        WHEN volume < 100 THEN '0-100'
        WHEN volume < 1000 THEN '100-1K'
        WHEN volume < 10000 THEN '1K-10K'
        WHEN volume < 100000 THEN '10K-100K'
        ELSE '100K+'
    END as volume_range,
    COUNT(*) as count
FROM keywords
WHERE volume IS NOT NULL
GROUP BY volume_range
ORDER BY MIN(volume);
"""
df = pd.read_sql_query(query, conn)
print(df)

conn.close()
```

---

## 常见问题

### Q1: 如何找到最有价值的需求方向？

**答案**: 综合考虑以下因素：
1. **搜索量**: 簇的总搜索量
2. **簇大小**: 关键词数量
3. **商业价值**: 是否有明确的变现路径
4. **竞争程度**: 查看相关商品数量

**推荐流程**:
```bash
# 1. 查看大簇（>50个关键词）
curl "http://127.0.0.1:8000/api/keywords/clusters/overview?stage=A&min_size=50"

# 2. 对于每个大簇，查看详情
curl "http://127.0.0.1:8000/api/keywords/clusters/42?stage=A"

# 3. 搜索相关商品
curl "http://127.0.0.1:8000/api/products/?search=area+code"

# 4. 评估机会
```

### Q2: 如何分析特定主题的市场机会？

**答案**: 使用关键词搜索 + 商品搜索

**示例**: 分析"planner"市场
```bash
# 1. 搜索相关关键词
curl "http://127.0.0.1:8000/api/keywords/?search=planner"

# 2. 搜索相关商品
curl "http://127.0.0.1:8000/api/products/?search=planner"

# 3. 分析需求量（关键词搜索量）
# 4. 分析供给量（商品数量）
# 5. 评估竞争程度（商品评分、评价数）
```

### Q3: 如何导出数据进行深度分析？

**方法1: 使用数据库查询工具**
```bash
python scripts/db_query_tool.py
# 选择选项 8
# 导出keywords或products表
```

**方法2: 使用Python脚本**
```python
import sqlite3
import pandas as pd

conn = sqlite3.connect('data/products.db')

# 导出所有关键词
df = pd.read_sql_query("SELECT * FROM keywords", conn)
df.to_excel('keywords_export.xlsx', index=False)

# 导出所有商品
df = pd.read_sql_query("SELECT * FROM products", conn)
df.to_excel('products_export.xlsx', index=False)

conn.close()
```

### Q4: 如何更新数据？

**更新关键词数据**:
```bash
# 通过API导入新数据
curl -X POST "http://127.0.0.1:8000/api/keywords/import" \
  -F "file=@data/new_keywords.csv"
```

**更新商品数据**:
```bash
# 通过API导入新数据
curl -X POST "http://127.0.0.1:8000/api/products/import" \
  -F "file=@data/new_products.csv"
```

### Q5: 如何备份数据？

**备份数据库**:
```bash
# 复制数据库文件
cp data/products.db data/products_backup_$(date +%Y%m%d).db
```

**导出CSV备份**:
```bash
python scripts/db_query_tool.py
# 选择选项 8
# 分别导出keywords和products表
```

---

## 最佳实践

### 1. 需求挖掘流程

**第一步: 宏观分析**
- 查看所有簇的概览
- 识别大簇（>50个关键词）
- 分析搜索量分布

**第二步: 深度分析**
- 对于每个大簇，查看详情
- 分析种子词组合
- 查看代表性关键词

**第三步: 市场验证**
- 搜索相关商品
- 分析竞争程度
- 评估商业价值

**第四步: 机会评估**
- 综合需求量和供给量
- 评估进入门槛
- 制定MVP方案

### 2. 数据分析技巧

**技巧1: 使用组合筛选**
```bash
# 查找高搜索量、非噪音的关键词
curl "http://127.0.0.1:8000/api/keywords/?is_noise=false&page_size=100"
```

**技巧2: 按簇分析**
```bash
# 先查看簇概览，再深入分析特定簇
curl "http://127.0.0.1:8000/api/keywords/clusters/overview?stage=A"
curl "http://127.0.0.1:8000/api/keywords/clusters/42?stage=A"
```

**技巧3: 交叉分析**
```bash
# 关键词 + 商品交叉分析
# 1. 找到高搜索量的关键词
# 2. 搜索相关商品
# 3. 评估供需关系
```

### 3. 工具使用建议

**日常使用**:
- 使用API文档进行快速查询
- 使用数据库查询工具进行深度分析
- 使用Python脚本进行自定义分析

**定期任务**:
- 每周导出数据备份
- 每月更新关键词数据
- 每季度重新运行聚类分析

**团队协作**:
- 使用API进行数据共享
- 导出Excel进行讨论
- 使用文档记录决策

### 4. 性能优化建议

**查询优化**:
- 使用分页避免一次性加载大量数据
- 使用筛选条件缩小结果集
- 合理使用缓存

**数据管理**:
- 定期清理无用数据
- 使用软删除保留历史
- 定期备份重要数据

---

## 附录

### A. API端点速查表

**词根聚类模块**:
- `GET /api/keywords/count` - 获取总数
- `GET /api/keywords/` - 获取列表
- `GET /api/keywords/seed-words` - 获取种子词
- `GET /api/keywords/clusters/overview` - 获取簇概览
- `GET /api/keywords/clusters/{id}` - 获取簇详情
- `POST /api/keywords/import` - 导入数据

**商品管理模块**:
- `GET /api/products/count` - 获取总数
- `GET /api/products/` - 获取列表
- `GET /api/products/{id}` - 获取详情
- `PUT /api/products/{id}` - 更新商品
- `DELETE /api/products/{id}` - 删除商品
- `POST /api/products/import` - 导入数据

### B. 数据库表结构

**keywords表** (25个字段):
- 主键: keyword_id
- 核心: keyword, seed_word, volume
- 聚类: cluster_id_a, cluster_size, is_noise
- 系统: import_time, is_deleted

**products表** (11个字段):
- 主键: product_id
- 核心: product_name, rating, review_count
- 聚类: cluster_id
- 系统: import_time, is_deleted

### C. 常用SQL查询

**查询最大的簇**:
```sql
SELECT cluster_id_a, COUNT(*) as size
FROM keywords
WHERE cluster_id_a IS NOT NULL AND cluster_id_a != -1
GROUP BY cluster_id_a
ORDER BY size DESC
LIMIT 10;
```

**查询种子词统计**:
```sql
SELECT seed_word, COUNT(*) as count, SUM(volume) as total_volume
FROM keywords
GROUP BY seed_word
ORDER BY count DESC;
```

**查询高评分商品**:
```sql
SELECT *
FROM products
WHERE rating >= 4.5
ORDER BY review_count DESC
LIMIT 20;
```

---

## 获取帮助

- **API文档**: http://127.0.0.1:8000/docs
- **项目文档**: `docs/` 目录
- **工具脚本**: `scripts/` 目录

---

**版本**: v2.0.0
**最后更新**: 2026-01-27
**作者**: Claude Sonnet 4.5
