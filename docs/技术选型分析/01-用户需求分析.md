# 技术选型文档 - 用户需求分析

**创建时间**: 2026-02-01
**文档版本**: v1.0
**目标**: 清晰定义用户真实需求，为技术选型提供依据

---

## 用户背景

### 项目基本信息
- **项目名称**: 词根聚类需求挖掘系统
- **开发时间**: 56天（119次提交）
- **当前状态**: 功能基本完成，但陷入bug修复循环
- **代码规模**: 27,105行（Python 17,437 + JSX 9,668）
- **数据规模**: 15,792条商品数据，1,411个聚类簇

### 用户痛点（原话）

1. **我的需求是一直在改代码**
   - 需求在不断变化和调整
   - 不是一次性完成的项目

2. **我需要最快的实现功能需求**
   - 速度优先，不是代码质量优先
   - 快速迭代比完美实现更重要

3. **我的需求在逐步优化调整**
   - 需求是迭代式的
   - 今天加功能A，明天可能改成功能B

4. **设计的方案也要可以符合迭代的点**
   - 架构要支持快速迭代
   - 加新功能不能影响旧功能

5. **让项目实际可用可迭代不是一直修复bug**
   - 核心诉求：能快速加功能，而不是陷入bug循环
   - 可用性 > 完美性

6. **Streamlit慢在切换上，比如从一个按钮点击到另一个按钮起码有10-50秒**
   - 之前用过Streamlit，因为切换慢（10-50秒）才放弃
   - 切换速度是硬性要求

---

## 真实需求提炼

### 核心需求（按优先级）

#### 1. 支持快速迭代（最高优先级）

**具体表现**：
- 加新功能时，只改少量代码（最好1个文件）
- 改代码时，不会影响其他功能
- 需求变化时，架构能快速适应

**当前问题**：
加一个新筛选条件需要改6个文件：
1. backend/services/product_service.py（加筛选逻辑）
2. backend/routers/products.py（加API参数）
3. backend/schemas/product.py（加数据模型）
4. frontend/src/api/products.js（加API调用）
5. frontend/src/pages/ProductList.jsx（加UI组件）
6. frontend/src/components/FilterBar.jsx（加筛选器）

结果：改6个文件 → 每个文件都可能出bug → 陷入修bug循环

**期望效果**：
- 只改1个文件
- 加3-5行代码
- 立即生效
- 不影响其他功能

#### 2. 避免bug循环（第二优先级）

**具体表现**：
- 加新功能不会引入新bug
- 改代码不会破坏旧功能
- 配置简单，不会出配置错误

**当前问题**：
- Bug修复率：47%（8个fix / 17个feat）
- 最常见bug：端口错误、API路径重复、路由冲突、配置不一致
- 修复一个bug，引入新bug

**期望效果**：
- Bug率 <10%
- 配置错误接近0
- 模块独立，互不影响

#### 3. 切换速度快（硬性要求）

**具体表现**：
- 点击按钮到显示结果 <1秒
- 不能像Streamlit那样10-50秒

**用户已验证**：
- Streamlit：10-50秒（不可接受）
- 当前React：<1秒（可接受）

#### 4. 快速实现功能（重要但非最高）

**具体表现**：
- 新功能能快速上线
- 不需要花很长时间开发

**注意**：
- 这不是项目要多久完成
- 而是每个新功能要多久实现

---

## 非需求（用户不关心的）

### 1. 代码优雅性
- 用户说：我不是要写好代码
- 代码质量 < 功能实现速度

### 2. 完美的UI
- 用户没有提UI要求
- 可用 > 美观

### 3. 多用户支持
- 单人使用
- 不需要考虑并发

### 4. 企业级架构
- 数据量：15,792条（不大）
- 用户：1人（不多）
- 不需要微服务、不需要复杂架构

---

## 需求背后的本质

### 为什么用户一直在改bug？

**表面原因**：
- 代码太多（27,105行）
- 配置太复杂（5个配置文件）
- 架构太复杂（18个Service，9个Router）

**深层原因**：
- 架构不支持快速迭代
- 加新功能需要改多个文件
- 改一个地方影响多个地方
- 模块间耦合严重

**根本原因**：
- 技术栈选择错误
- 选择了企业级技术栈（React + FastAPI + 微服务架构）
- 但需求是快速迭代的数据分析工具
- 技术栈复杂度 >> 需求复杂度

### 用户真正需要什么？

**不是**：
- 一个完美的系统
- 一个企业级的架构
- 一个优雅的代码库

**而是**：
- 一个能快速加功能的架构
- 一个不会陷入bug循环的架构
- 一个切换速度快的架构

---

## 需求量化指标

### 必须满足的指标

| 指标 | 目标值 | 当前值 | 差距 |
|------|--------|--------|------|
| 加新功能改动文件数 | <=2个 | 6个 | 3倍 |
| 加新功能代码行数 | <=10行 | 50+行 | 5倍 |
| Bug率 | <10% | 47% | 4.7倍 |
| 切换速度 | <1秒 | <1秒 | 达标 |
| 配置文件数 | 1个 | 5个 | 5倍 |

### 期望满足的指标

| 指标 | 目标值 | 说明 |
|------|--------|------|
| 新功能开发时间 | <1天 | 从需求到上线 |
| 代码总量 | <5,000行 | 易于维护 |
| 学习成本 | <1天 | 新人能快速上手 |

---

## 技术选型的评判标准

基于以上需求分析，技术选型应该满足：

### 1. 支持快速迭代（权重：40%）
- 加新功能改动少
- 模块独立，互不影响
- 配置简单

### 2. 避免bug循环（权重：30%）
- 架构简单
- 配置少
- 前后端耦合度低

### 3. 切换速度快（权重：20%）
- <1秒响应
- 不能像Streamlit那样慢

### 4. 开发速度快（权重：10%）
- 能快速实现新功能
- 学习成本低

---

## 总结

用户的核心诉求是：
1. 能快速加新功能（改1个文件，加几行代码）
2. 不会陷入bug循环（架构简单，配置少）
3. 切换速度快（<1秒，不是10-50秒）

技术选型必须围绕这三点展开，而不是追求：
- 代码优雅
- 架构完美
- 企业级特性

**下一步**：基于这些需求，分析当前架构的问题，并提出解决方案。
