# 词根管理功能使用指南

## 📌 概述

词根管理功能用于管理所有的seed_word（词根），为每个词根分配Token类别（intent/action/object/other），添加定义和业务价值，并关联到需求卡片。

## 🚀 快速开始

### 1. 首次使用 - 导入现有词根

如果您的数据库中已经有phrases数据（包含seed_word字段），可以一键导入：

1. 打开Web界面，进入 **🌱 词根管理** 页面
2. 在 **📊 词根列表** 标签页，点击 **"📥 从Phrases表导入词根"**
3. 系统会自动从phrases表提取所有唯一的seed_word并导入

### 2. 为词根分类

导入后的词根处于"未分类"状态，需要手动分配Token类别：

1. 进入 **➕ 添加/编辑词根** 标签页
2. 选择"编辑现有词根"
3. 从列表中选择要编辑的词根
4. **Token分类区域**：
   - 勾选所有适用的类别（可多选）
   - 从已选类别中指定"主要类别"
   - 参考示例文本了解每个类别的含义
5. 填写定义、商业价值、用户场景等信息
6. 设置状态、优先级、审核状态
7. 点击"💾 保存"

### 3. 关联需求

将词根与需求卡片关联：

1. 进入 **🔗 词根与需求关联** 标签页
2. 左侧选择词根
3. 右侧选择需求卡片
4. 勾选"设为主要关联"（如果这是该词根最重要的需求）
5. 点击"🔗 建立关联"

### 4. 查看统计

在 **📈 词根统计** 标签页可以查看：
- 总体统计（词根总数、已审核数、审核率）
- 按Token类别分布
- 按状态分布
- Top 20高扩展词根

## 🏷️ Token框架说明

词根管理使用4类Token框架进行分类：

### 1. intent（意图词）
- **含义**：用户想要什么
- **示例**：best, top, cheap, free, how to, guide, tutorial
- **用途**：表达用户的搜索意图和期望

### 2. action（动作词）
- **含义**：用户要做什么
- **示例**：download, buy, create, install, compare, learn
- **用途**：描述用户想要执行的操作

### 3. object（对象词）
- **含义**：涉及什么东西
- **示例**：calculator, phone, software, app, template
- **用途**：表示搜索的具体对象或主题

### 4. other（其他）
- **含义**：不属于上述三类的词
- **示例**：2024, windows, google, new york, python
- **用途**：数字、品牌名、地名、技术栈等

## 💡 多分类支持

一个词根可以同时属于多个类别。例如：
- "best" 既可以是 intent（意图：想要最好的），也可以是 attribute（属性：最好的）
- 系统会要求指定一个"主要类别"，用于排序和筛选

## 📊 统计信息

每个词根会自动计算以下统计信息（从phrases表聚合）：
- **扩展数**：该词根扩展了多少个关键词短语
- **总搜索量**：所有关联短语的搜索量之和
- **平均频次**：关联短语的平均出现频次

点击"🔄 更新所有词根统计"可以重新计算这些数据。

## ⚙️ 批量操作

### 更新统计
- 点击"🔄 更新所有词根统计"，从phrases表重新计算所有词根的扩展数、总搜索量等

### 同步新词根
- 点击"📥 同步新词根"，从phrases表导入新增的seed_word

## 🔍 筛选功能

在词根列表中支持多种筛选：
- **按主要类别筛选**：只显示特定Token类别的词根
- **按状态筛选**：active（活跃）、paused（暂停）、archived（归档）
- **仅显示已审核**：只显示verified=true的词根

## 📝 字段说明

### 基本信息
- **词根文本**：seed_word的文本（英文小写）
- **状态**：active/paused/archived
- **Token分类**：可多选的类别
- **主要类别**：从已选类别中指定一个

### 定义与场景
- **词根定义**：解释这个词根的含义和用途
- **商业价值**：说明该词根的商业价值和重要性
- **用户场景**：描述用户在什么场景下会使用相关关键词

### 管理字段
- **优先级**：high/medium/low
- **已审核**：是否经过人工审核
- **置信度**：分类的置信度（high/medium/low）
- **备注**：其他补充说明

### 关联字段
- **关联需求**：该词根关联的需求卡片ID列表
- **主要关联需求**：最重要的关联需求

## 🛠️ 数据库迁移

如果遇到"Unknown column"错误，需要运行数据库迁移脚本：

```bash
# 添加token_types列（支持多分类）
python scripts/migrate_seed_words_multi_classification.py

# 重命名token_type为primary_token_type
python scripts/migrate_rename_token_type.py

# 验证表结构
python scripts/verify_seed_words_table.py
```

## 📌 最佳实践

1. **初次导入后立即分类**：导入词根后，尽快为高频词根分配Token类别
2. **定期更新统计**：在导入新的phrases数据后，记得更新词根统计信息
3. **使用多分类**：如果一个词根确实有多重含义，不要犹豫使用多分类
4. **关联需求**：将词根与需求关联后，可以更好地追踪词根的应用场景
5. **设置优先级**：为重要词根设置高优先级，便于后续筛选和处理

## ❓ 常见问题

### Q: 导入后词根显示"未分类"？
A: 正常现象，导入时系统不会自动分配Token类别，需要手动编辑分类。

### Q: 可以批量分类吗？
A: 当前版本需要逐个编辑。未来可以考虑添加批量分类功能。

### Q: 扩展数为0是什么意思？
A: 说明phrases表中没有使用该seed_word的记录，可能是手动添加的词根。

### Q: 如何删除词根？
A: 当前版本不支持UI删除，可以将状态改为"archived"（归档）。

---

**提示**：词根管理是整个需求挖掘流程的基础，建议在Phase 0完成后、Phase 2之前完成词根分类工作。
