# 需求挖掘系统 - 统一需求文档

**项目名称**: 需求挖掘系统 (Demand Mining System)
**文档版本**: v4.2
**创建日期**: 2026-01-27
**最后更新**: 2026-01-28

---

## 📋 项目概述

### 项目定位

基于多数据源的需求挖掘与分析平台，通过语义聚类和AI分析，从海量数据中发现产品机会方向。

### 核心理念

**从数据 → 聚类 → 需求 → 产品验证**

### 目标用户

- 产品经理
- 需求分析师
- 市场研究人员
- 创业者（个人使用）

### 系统架构

```
需求挖掘系统 v2.0
├── 模块一：词根聚类模块（长尾词分析）- 独立运行
├── 模块二：商品管理模块（Etsy商品分析）- 独立运行
└── 模块三：Reddit模块（预留）- 独立运行
```

**重要说明**: 每个模块都有自己独立的阶段体系，可以独立运行和开发。

---

## 🎯 模块一：词根聚类模块（长尾词分析）

### 模块概述

**核心目标**: 从英文单词种子发现产品机会方向

**数据来源**: SEMrush / Reddit / Related Search

**核心流程**: 单词 → 短语 → 语义簇 → 需求方向 → MVP验证

**独立性**: 本模块可独立运行，不依赖其他模块

---

### 模块工作流程（独立阶段体系）

本模块采用两阶段工作流程：**阶段A（种子词扩展与聚类）** 和 **阶段B（方向深化与需求分析）**

---

#### 📍 阶段A：种子词扩展与聚类

**目标**: 从种子词扩展到短语，并进行语义聚类，发现初步需求方向

##### A1: 种子词准备
- **状态**: ✅ 已完成
- **输入**: 无
- **输出**: 46个英文单词种子
- **示例**: compress, convert, generate, track, optimize
- **验收标准**:
  - 种子词数量: 40-50个
  - 覆盖领域: 工具类、内容类、分析类等

##### A2: 短语扩展
- **状态**: ✅ 已完成
- **输入**: 种子词列表
- **方式**: SEMrush / Reddit / Related Search（影刀RPA自动采集）
- **输出**: `merged_keywords_all.csv`（1000-5000条短语）
- **字段**: keyword, seed_word, seed_group, source, volume, intent等
- **验收标准**:
  - 短语数量: 5,000-10,000条
  - 数据质量: 去重、清洗完成
  - 字段完整性: 必需字段100%填充

##### A3: 语义聚类
- **状态**: ✅ 已完成
- **输入**: `merged_keywords_all.csv`
- **算法**: Sentence Transformers (all-MiniLM-L6-v2) + HDBSCAN
- **参数**: min_cluster_size=15, min_samples=3（可调）
- **输出**:
  - `stageA_clusters.csv`（短语级，带cluster_id_A）
  - `cluster_summary_A3.csv`（簇级汇总）
- **验收标准**:
  - 簇数量: 60-100个
  - 噪音比例: <25%
  - 聚类覆盖率: >95%
  - 语义连贯性: 高
- **当前结果**: 63个簇，噪音3.4%，覆盖率96.6%

##### A4: 簇解释（AI辅助）
- **状态**: ⏳ 待实现
- **输入**: `cluster_summary_A3.csv`
- **方式**: Claude API / DeepSeek API
- **输出**: 每个簇的语义解释和核心主题
- **字段**: cluster_label, cluster_explanation
- **验收标准**:
  - 解释准确率: >80%
  - 处理时间: <5秒/簇
  - API成功率: >95%

##### A5: 人工筛选方向
- **状态**: ⏳ 待实现
- **输入**: `cluster_summary_A3.csv`（带AI解释）
- **方式**: 人工审查 + Trends验证
- **输出**: `direction_keywords.csv`（5-10个方向）
- **字段**: direction_keyword, from_cluster_id_A, priority等
- **验收标准**:
  - 方向数量: 5-10个
  - 每个方向有明确的商业价值
  - Trends验证通过

---

#### 📍 阶段B：方向深化与需求分析

**目标**: 对筛选出的方向进行深度扩展和分析，生成可执行的需求报告

##### B1: 方向扩展
- **状态**: ⏳ 待实现
- **输入**: `direction_keywords.csv`
- **方式**: SEMrush / Reddit（针对每个方向再次扩展）
- **输出**: 每个方向扩展500-2000条短语
- **文件**: `raw_phrases_stageB.csv`
- **验收标准**:
  - 每个方向短语数: 500-2000条
  - 数据质量: 去重、清洗完成
  - 相关性: >90%

##### B2: 数据清洗（预留）
- **状态**: 📝 规划中
- **输入**: `raw_phrases_stageB.csv`
- **输出**: `cleaned_phrases_stageB.csv`
- **功能**: 去重、过滤低质量数据

##### B3: 方向内聚类
- **状态**: ⏳ 待实现
- **输入**: 方向扩展结果
- **算法**: HDBSCAN（每个方向内部再聚类）
- **输出**: `stageB_clusters.csv`（方向内的子簇，10-30个）
- **字段**: cluster_id_B, direction_keyword等
- **验收标准**:
  - 每个方向子簇数: 10-30个
  - 噪音比例: <20%
  - 语义连贯性: 高

##### B4: 子簇解释（预留）
- **状态**: 📝 规划中
- **输入**: `stageB_clusters.csv`
- **方式**: AI辅助
- **输出**: 子簇语义解释

##### B5: 子簇筛选（预留）
- **状态**: 📝 规划中
- **输入**: 带解释的子簇
- **输出**: 筛选后的高价值子簇

##### B6: 需求分析（5维框架）
- **状态**: ⏳ 待实现
- **输入**: 方向内子簇
- **方式**: Claude API + 5维框架分析
- **5维框架**:
  1. What - 用户要做什么
  2. Why - 为什么要做
  3. Who - 什么人群
  4. When - 什么场景
  5. How - 如何解决
- **输出**: 需求分析报告
- **验收标准**:
  - 分析深度: 5维框架完整
  - 可执行性: 有明确的MVP方案
  - 验证建议: 包含SERP和访谈建议

##### B7: MVP方案设计（预留）
- **状态**: 📝 规划中
- **输入**: 需求分析报告
- **输出**: MVP实施方案

##### B8: 验证计划（预留）
- **状态**: 📝 规划中
- **输入**: MVP方案
- **输出**: 验证计划和指标

---

### 当前实现状态

**阶段A完成度**: 60% (3/5)
- ✅ A1: 种子词准备
- ✅ A2: 短语扩展（6,565个关键词）
- ✅ A3: 语义聚类（63个簇，噪音3.4%）
- ⏳ A4: AI簇解释
- ⏳ A5: 人工筛选方向

**阶段B完成度**: 0% (0/8)
- ⏳ B1: 方向扩展
- 📝 B2: 数据清洗（预留）
- ⏳ B3: 方向内聚类
- 📝 B4: 子簇解释（预留）
- 📝 B5: 子簇筛选（预留）
- ⏳ B6: 需求分析（5维框架）
- 📝 B7: MVP方案设计（预留）
- 📝 B8: 验证计划（预留）

**模块总完成度**: 23% (3/13)

### 数据字段规范

#### 短语级字段（stageA_clusters.csv）

| 字段名 | 类型 | 必需 | 说明 |
|--------|------|------|------|
| keyword | string | ✅ | 短语内容 |
| seed_word | string | ✅ | 来源种子词 |
| seed_group | string | ✅ | 种子词分组 |
| source | string | ✅ | 数据来源（semrush/reddit/related_search） |
| volume | int | ⏳ | 月搜索量 |
| intent | string | ⏳ | 搜索意图 |
| cluster_id_a | int | ✅ | 簇ID（-1表示噪音） |
| cluster_size | int | ✅ | 簇大小 |
| is_noise | bool | ✅ | 是否噪音点 |
| word_count | int | ✅ | 单词数 |
| phrase_length | int | ✅ | 字符长度 |

#### 簇级字段（cluster_summary_A3.csv）

| 字段名 | 类型 | 必需 | 说明 |
|--------|------|------|------|
| cluster_id | int | ✅ | 簇ID |
| stage | string | ✅ | 阶段标识（A/B） |
| cluster_size | int | ✅ | 簇大小 |
| seed_words_in_cluster | string | ✅ | 簇内种子词列表 |
| top_keywords | string | ✅ | 代表性短语（前5个） |
| example_phrases | string | ✅ | 示例短语 |
| cluster_label | string | ⏳ | 簇标签（AI生成） |
| cluster_explanation | string | ⏳ | 簇解释（AI生成） |
| avg_volume | int | ⏳ | 平均搜索量 |
| total_volume | int | ⏳ | 总搜索量 |

### 核心原则

1. **只分组，不删除**
   - 聚类只分组，不过滤
   - 噪音点保留，人工决定是否使用
   - 筛选标记low priority，不删除

2. **轻量版起步**
   - Phase 1: A2 → A3 → 人工筛选
   - Phase 2: B1 → B3 → B6
   - Phase 3: 大模型 + Trends + 需求库

3. **大模型输出是假设**
   - A4的簇解释需要SERP验证
   - B6的5维框架需要访谈验证
   - 决策优先级: SERP+访谈 > BI > 经验 > 模型

### 质量指标

- ✅ 簇数量: 60-100个（当前63个）
- ✅ 噪音比例: <25%（当前3.4%）
- ✅ 聚类覆盖率: >95%（当前96.6%）
- ✅ 语义连贯性: 高（同簇关键词语义相关）

---

## 🛍️ 模块二：商品管理模块（Etsy商品分析）

### 模块概述

**核心目标**: 分析市场供给情况，识别交付产品类型

**数据来源**: Etsy平台

**核心价值**: 需求-供给匹配分析

**独立性**: 本模块可独立运行，不依赖其他模块

---

### 模块工作流程（独立阶段体系）

本模块采用三阶段工作流程：**阶段P1（数据管理）**、**阶段P2（聚类分析）** 和 **阶段P3（AI增强）**

---

#### 📍 阶段P1：数据管理

**目标**: 建立商品数据的导入、管理和导出能力

##### P1.1: 数据导入功能
- **状态**: ✅ 已完成
- **原编号**: REQ-001
- **需求描述**: 支持从Excel/CSV文件导入Etsy商品数据
- **输入格式**:
  - 文件格式: Excel (.xlsx, .xls) 或 CSV (.csv)
  - 文件结构: **无表头**（第一行就是数据）
  - 固定5列结构:
    - 列0: 商品名称 (product_name) - 必填
    - 列1: 评分 (rating) - 可选，0-5
    - 列2: 评价数量 (review_count) - 可选，带括号和单位
    - 列3: 店铺名称 (shop_name) - 可选
    - 列4: 价格 (price) - 可选
- **数据预处理**:
  - 评价数量转换: (1.1k) → 1100, (2.5m) → 2500000
  - 去除空格、货币符号
  - 缺失值标记为NULL
  - 评分验证范围（0-5）
- **验收标准**:
  - ✅ 能够成功上传Excel和CSV文件
  - ✅ 能够正确解析无表头的5列数据
  - ✅ 能够正确转换评价数量
  - ✅ 能够处理10,000+条商品数据
  - ✅ 导入时间<30秒（10,000条）
  - ✅ 数据预处理准确率>99%

##### P1.2: 数据管理功能
- **状态**: ✅ 已修复
- **原编号**: REQ-002
- **优先级**: 🔴 P0 - 紧急修复
- **需求描述**: 对导入的商品数据进行查看、编辑、删除等基本管理操作
- **修复说明** (2026-01-28):
  - ✅ 搜索功能已修复（参数名从keyword改为search）
  - ✅ 排序功能已修复（修复参数解析逻辑）
  - ✅ 翻页功能已验证正常
  - ✅ 筛选功能已验证正常（价格范围筛选测试通过）
  - **提交**: commit 6bb0185c
- **查询功能**:
  - 商品列表展示（分页，每页50条）
  - 全文搜索（商品名称）
  - 多条件筛选: 评分范围、价格范围、店铺名称、簇ID
  - 多字段排序
- **编辑功能**:
  - 单条编辑: 更新商品信息
  - 批量删除: 软删除（标记is_deleted=true）
- **验收标准**:
  - ✅ 排序功能正常工作
  - ✅ 筛选功能正常工作
  - ✅ 翻页功能正常工作
  - ✅ 搜索功能正常工作
  - ✅ 能够流畅展示10,000+条数据
  - ✅ 搜索响应时间<1秒
  - ✅ 能够正确筛选和排序
  - ⏳ 能够成功编辑和保存（待测试）
  - ⏳ 能够批量删除数据（待测试）

##### P1.3: 数据导出功能
- **状态**: ✅ 已完成
- **原编号**: REQ-007
- **需求描述**: 支持导出各阶段的数据结果
- **导出类型**:
  - 原始商品数据
  - 聚类结果（带cluster_id）
  - 簇级汇总
- **导出格式**: CSV格式、Excel格式
- **验收标准**:
  - ✅ 能够导出所有类型的数据
  - ✅ 导出时间<30秒（10,000条）
  - ✅ 导出的文件格式正确
  - ✅ 能够在Excel中正常打开

---

#### 📍 阶段P2：聚类分析

**目标**: 基于商品名称进行语义聚类，自动分组相似商品

##### P2.1: 语义聚类分析
- **状态**: ✅ 已完成
- **原编号**: REQ-003
- **需求描述**: 基于商品名称进行语义聚类，自动分组相似商品
- **完成说明** (2026-01-29):
  - ✅ 前端添加"开始聚类"按钮
  - ✅ 实现聚类确认对话框
  - ✅ 实现聚类加载状态提示
  - ✅ 聚类完成后自动切换到结果Tab
  - **提交**: commit 053bfbee
  - **优先级**: P0 - 已完成
- **技术实现**:
  - 向量化: Sentence Transformers (all-MiniLM-L6-v2)
  - 聚类算法: HDBSCAN
  - 参数: min_cluster_size=15, min_samples=5（可调）
  - 向量缓存: MD5哈希 + pickle缓存
- **聚类流程**:
  1. 读取商品数据
  2. 生成文本向量（带缓存）
  3. HDBSCAN聚类
  4. 更新cluster_id字段
  5. 生成簇级汇总
- **验收标准**:
  - [ ] 前端有"开始聚类"按钮或入口
  - [ ] 点击后能触发聚类操作
  - [ ] 显示聚类进度或状态
  - [ ] 能够对10,000条商品进行聚类
  - [ ] 聚类时间<5分钟（10,000条）
  - [ ] 生成50-100个有意义的簇
  - [ ] 噪音比例<25%
  - [ ] 簇内商品语义相似度高

##### P2.2: 聚类结果展示
- **状态**: ✅ 已完成
- **原编号**: REQ-006
- **需求描述**: 以直观的方式展示聚类结果和分析结果
- **完成说明** (2026-01-29):
  - ✅ 创建 ClusterOverview 组件
  - ✅ 显示聚类统计卡片（总簇数、已聚类商品、噪音点、聚类覆盖率）
  - ✅ 显示簇概览表格（簇ID、簇大小、平均评分、平均价格、总评价数、示例商品）
  - ✅ 添加"聚类结果" Tab 页
  - ✅ 支持刷新聚类数据
  - **提交**: commit 053bfbee
  - **优先级**: P0 - 已完成
- **展示功能**:
  - 簇概览: 显示所有簇的统计信息
  - 簇详情: 查看每个簇包含的商品
  - 簇统计: 大小、评分、价格、评价数
  - 噪音点展示: 单独展示未聚类的商品
  - 搜索筛选: 支持关键词搜索、按大小筛选
- **统计信息**:
  - 簇大小分布
  - 评分分布
  - 价格分布
  - Top 5热门商品
- **验收标准**:
  - [ ] 前端有"查看聚类结果"或"簇概览"入口
  - [ ] 能够清晰展示所有簇
  - [ ] 能够查看簇详情
  - [ ] 商品列表显示 cluster_id 字段
  - [ ] 能够按簇ID筛选商品
  - [ ] 页面加载时间<2秒
  - [ ] 支持筛选和搜索

---

#### 📍 阶段P3：AI增强

**目标**: 使用AI分析商品簇，识别用户需求和交付产品类型

##### P3.1: 需求分析（AI辅助）
- **状态**: ⏳ 待实现
- **原编号**: REQ-004
- **需求描述**: 使用DeepSeek API分析每个簇的商品，识别满足的用户需求
- **分析流程**:
  - 对每个聚类簇调用DeepSeek API
  - 分析该簇商品满足的用户需求
  - 生成需求描述（例如: 项目管理、任务管理、时间管理等）
  - 支持批量分析和单个簇分析
- **API调用**:
  - 输入: 簇内商品列表（名称）
  - Prompt: 分析这些商品满足的用户需求
  - 输出: 需求描述（JSON格式）
  - 错误处理: API调用失败重试3次
- **验收标准**:
  - [ ] 能够成功调用DeepSeek API
  - [ ] 生成的需求描述准确且有价值
  - [ ] 单个簇分析时间<10秒
  - [ ] 批量分析支持断点续传

##### P3.2: 交付产品识别（AI辅助）
- **状态**: ⏳ 待实现
- **原编号**: REQ-005
- **需求描述**: 从商品名称中自动识别交付产品的类型、格式和平台
- **识别内容**:
  - 交付类型: Excel、PPT、模板、压缩包等
  - 具体格式: Excel模板、PPT模板、Notion模板等
  - 交付平台: Notion、Canva、Google Sheets等
- **实现方式**:
  - 混合策略: 关键词规则 + AI识别
  - 关键词规则: 快速识别常见类型
  - AI识别: 处理复杂和模糊情况
- **验收标准**:
  - [ ] 能够准确识别交付产品类型
  - [ ] 识别准确率>80%
  - [ ] 单个商品识别时间<5秒
  - [ ] 批量识别支持断点续传

---

#### 📍 阶段P4：聚类增强（新增）

**目标**: 增强聚类结果的可读性和可用性

##### P4.1: 类别名称生成
- **状态**: ⏳ 待实现
- **原编号**: REQ-008
- **优先级**: 🟠 P1 - 高优先级
- **需求描述**: 为每个聚类簇生成可读的类别名称
- **实现方式**:
  - 对每个簇调用AI（Claude/DeepSeek）
  - 输入：簇内Top 5商品名称
  - 输出：类别名称（如"Budget & Finance Planning"）
  - 存储到：`cluster_summaries.cluster_name`
- **数据规模**:
  - 簇数量：63个
  - API调用次数：63次
  - 预计成本：$0.3-0.5
- **验收标准**:
  - [ ] 能够成功调用AI生成类别名
  - [ ] 类别名准确且易懂
  - [ ] 生成时间<5分钟（63个簇）
  - [ ] 支持人工修正类别名

##### P4.2: 复杂筛选功能
- **状态**: ⏳ 待实现
- **原编号**: REQ-009
- **优先级**: 🟡 P2 - 中优先级
- **需求描述**: 在商品表格中实现复杂的多条件筛选
- **筛选维度**:
  - 按类别名称筛选
  - 按评价数范围筛选（如：1000-5000）
  - 按评分范围筛选（如：4.0-5.0）
  - 按价格范围筛选（如：$5-$10）
  - 多条件组合筛选
- **实现方式**:
  - 纯代码实现（SQL查询）
  - 前端UI：下拉框、输入框、滑块
- **验收标准**:
  - [ ] 能够按类别筛选商品
  - [ ] 能够按评价数范围筛选
  - [ ] 能够按评分范围筛选
  - [ ] 能够按价格范围筛选
  - [ ] 支持多条件组合
  - [ ] 筛选响应时间<1秒

---

#### 📍 阶段P5：商品属性提取（新增）

**目标**: 为每个商品提取关键属性信息

##### P5.1: 商品属性提取（代码规则）
- **状态**: ⏳ 待实现
- **原编号**: REQ-010
- **优先级**: 🟢 P3 - 中优先级
- **需求描述**: 使用代码规则从商品名称中提取交付形式和关键词
- **提取内容**:
  1. **交付形式**（delivery_type）
     - 关键词规则库：
       - "template" → Template
       - "planner" → Planner
       - "tracker" → Tracker
       - "worksheet" → Worksheet
       - "printable" → Printable
       - "bundle" → Bundle
       - "kit" → Kit
       - "guide" → Guide
       - "checklist" → Checklist
       - "calendar" → Calendar
     - 平台规则：
       - "notion" → Notion Template
       - "canva" → Canva Template
       - "excel" → Excel Template
       - "google sheets" → Google Sheets Template

  2. **关键词提取**（key_keywords）
     - 使用NLP提取名词短语
     - 提取商品名中的核心词汇
     - 例如："Budget Planner Template" → "Budget, Planner, Template"
- **实现方式**:
  - 纯代码实现（Python）
  - 批量处理所有商品
  - 0成本
- **验收标准**:
  - [ ] 能够提取交付形式
  - [ ] 提取准确率>70%
  - [ ] 能够提取关键词
  - [ ] 批量处理时间<5分钟（10,000条）

##### P5.2: Top商品AI深度分析
- **状态**: ⏳ 待实现
- **原编号**: REQ-011
- **优先级**: 🔵 P4 - 中低优先级
- **需求描述**: 对每个簇的Top商品进行AI深度分析
- **分析对象**:
  - 每个簇的Top 3商品（按评价数排序）
  - 总计：63簇 × 3商品 = 189个商品
- **分析内容**:
  1. 满足的用户需求（user_need）
  2. 验证交付形式（验证代码提取结果）
  3. 补充关键词（补充代码未提取的）
- **实现方式**:
  - 调用AI（Claude/DeepSeek）
  - 其他商品继承所属簇的"满足的需求"
  - 预计成本：$1.5-3
- **验收标准**:
  - [ ] 能够成功分析Top商品
  - [ ] 分析结果准确且有价值
  - [ ] 其他商品能继承簇的分析结果
  - [ ] 总处理时间<30分钟

##### P5.3: AI辅助兜底
- **状态**: ⏳ 待实现
- **原编号**: REQ-012
- **优先级**: 🟣 P5 - 低优先级
- **需求描述**: 对代码规则无法提取交付形式的商品，使用AI补充
- **处理对象**:
  - 代码规则无法匹配的商品
  - 预计：10-20%的商品（30-60个）
- **实现方式**:
  - 调用AI识别交付形式
  - 预计成本：$0.2-0.5
- **验收标准**:
  - [ ] 能够识别边缘情况
  - [ ] 识别准确率>80%
  - [ ] 处理时间<10分钟

---

#### 📍 阶段P6：数据可视化（新增）

**目标**: 通过图表直观展示聚类和商品数据

##### P6.1: 数据可视化
- **状态**: ✅ 已完成
- **原编号**: REQ-013
- **优先级**: ⚪ P6 - 已完成
- **需求描述**: 在商品管理页面增加数据可视化图表
- **完成说明** (2026-01-29):
  - ✅ 后端实现可视化数据API
  - ✅ 前端安装 ECharts 和 echarts-for-react
  - ✅ 创建 ProductVisualization 组件
  - ✅ 实现5种图表类型
  - ✅ 在 ProductManagement 页面添加"数据可视化" Tab
  - **提交**: commits 258eeffa (后端), 08088a6f (前端)
- **图表类型**:
  1. ✅ 类别大小分布（柱状图）
  2. ✅ 评分分布（柱状图）
  3. ✅ 价格分布（柱状图）
  4. ✅ 交付形式分布（饼图）
  5. ✅ 评价数分布（柱状图）

---

### 当前实现状态

**阶段P1完成度**: 100% (3/3)
- ✅ P1.1: 数据导入功能
- ✅ P1.2: 数据管理功能（已修复）
- ✅ P1.3: 数据导出功能

**阶段P2完成度**: 100% (2/2)
- ✅ P2.1: 语义聚类分析（前端已实现）
- ✅ P2.2: 聚类结果展示（前端已实现）

**阶段P3完成度**: 0% (0/2)
- ⏳ P3.1: 需求分析（AI辅助）
- ⏳ P3.2: 交付产品识别（AI辅助）

**阶段P4完成度**: 0% (0/2)
- ⏳ P4.1: 类别名称生成 🟠 P1
- ⏳ P4.2: 复杂筛选功能 🟡 P2

**阶段P5完成度**: 0% (0/3)
- ⏳ P5.1: 商品属性提取（代码规则）🟢 P3
- ⏳ P5.2: Top商品AI深度分析 🔵 P4
- ⏳ P5.3: AI辅助兜底 🟣 P5

**阶段P6完成度**: 100% (1/1)
- ✅ P6.1: 数据可视化 ⚪ P6

**模块总完成度**: 45% (5/11)

---

### 数据字段规范

#### 商品表（products）

| 字段名 | 类型 | 必需 | 说明 |
|--------|------|------|------|
| product_id | int | ✅ | 商品ID（主键） |
| product_name | string | ✅ | 商品名称 |
| rating | float | ❌ | 评分（0-5） |
| review_count | int | ❌ | 评价数量 |
| shop_name | string | ❌ | 店铺名称 |
| price | float | ❌ | 价格 |
| cluster_id | int | ❌ | 簇ID |
| cluster_name | string | ❌ | 类别名称（新增，P4.1） |
| delivery_type | string | ❌ | 交付形式（新增，P5.1） |
| key_keywords | string | ❌ | 关键词（新增，P5.1） |
| user_need | string | ❌ | 满足的需求（新增，P5.2） |
| import_time | datetime | ✅ | 导入时间 |
| is_deleted | boolean | ✅ | 是否删除 |

#### 簇汇总表（cluster_summaries）

| 字段名 | 类型 | 必需 | 说明 |
|--------|------|------|------|
| cluster_id | int | ✅ | 簇ID（主键） |
| cluster_name | string | ❌ | 类别名称（新增，P4.1） |
| cluster_size | int | ✅ | 簇大小 |
| top_keywords | string | ✅ | 代表性商品 |
| avg_rating | float | ❌ | 平均评分 |
| total_volume | int | ❌ | 总评价数 |
| common_delivery_type | string | ❌ | 常见交付形式（新增，P5.2） |
| user_need | string | ❌ | 满足的需求（新增，P5.2） |

### 核心数据

- **345个商品**（Etsy平台）
- **11个字段**
- **聚类完成率**: 99.1%

### 核心原则

1. **只分组，不删除**
   - 聚类只分组，不过滤
   - 软删除保留历史

2. **需求-供给匹配**
   - 与模块一（词根聚类）配合
   - 发现市场机会

3. **AI辅助决策**
   - AI输出是假设，需要验证
   - 人工审核最终决策

### 质量指标

- ✅ 聚类完成率: >95%（当前99.1%）
- ✅ 数据预处理准确率: >99%
- ⏳ AI识别准确率: >80%（待实现）

---

**功能详细说明**:

**1. 输入格式**
- 文件格式: Excel (.xlsx, .xls) 或 CSV (.csv)
- 文件结构: **无表头**（第一行就是数据）
- 固定5列结构:
  - 列0: 商品名称 (product_name) - 必填
  - 列1: 评分 (rating) - 可选，0-5
  - 列2: 评价数量 (review_count) - 可选，带括号和单位
  - 列3: 店铺名称 (shop_name) - 可选
  - 列4: 价格 (price) - 可选

**2. 数据预处理**

**评价数量转换规则**:
```
(1.1k) → 1100
(19.1k) → 19100
(9.8k) → 9800
(15) → 15
(2.5m) → 2500000
```

**处理步骤**:
1. 去除括号: (1.1k) → 1.1k
2. 识别单位: k/K → ×1000, m/M → ×1000000
3. 转换为整数

**其他清洗**:
- 去除所有字段的前后空格
- 价格去除货币符号（$、€等）
- 缺失值标记为NULL
- 评分验证范围（0-5）

**3. 验收标准**
- ✅ 能够成功上传Excel和CSV文件
- ✅ 能够正确解析无表头的5列数据
- ✅ 能够正确转换评价数量
- ✅ 能够处理10,000+条商品数据
- ✅ 导入时间<30秒（10,000条）
- ✅ 数据预处理准确率>99%

---

#### REQ-002: 数据管理功能 ⚠️ 需要修复

**需求描述**: 对导入的商品数据进行查看、编辑、删除等基本管理操作

**问题说明** (2026-01-28):
- ❌ 排序功能不可用
- ❌ 筛选功能不可用
- ❌ 翻页功能不可用
- ❌ 搜索功能不可用
- **影响**: 商品管理页面核心功能瘫痪，无法正常使用
- **优先级**: P0 - 紧急修复

**功能详细说明**:

**1. 查询功能**
- 商品列表展示（分页，每页50条）
- 全文搜索（商品名称）
- 多条件筛选:
  - 评分范围 (min_rating, max_rating)
  - 价格范围 (min_price, max_price)
  - 店铺名称
  - 簇ID (cluster_id)
- 多字段排序

**2. 编辑功能**
- 单条编辑: 更新商品信息
- 批量删除: 软删除（标记is_deleted=true）

**3. 验收标准**
- [ ] 排序功能正常工作
- [ ] 筛选功能正常工作
- [ ] 翻页功能正常工作
- [ ] 搜索功能正常工作
- [ ] 能够流畅展示10,000+条数据
- [ ] 搜索响应时间<1秒
- [ ] 能够正确筛选和排序
- [ ] 能够成功编辑和保存
- [ ] 能够批量删除数据

---

#### REQ-003: 语义聚类分析 ⚠️ 前端未实现

**需求描述**: 基于商品名称进行语义聚类，自动分组相似商品

**问题说明** (2026-01-28):
- ❌ 前端界面缺少聚类功能入口
- ❌ 没有"开始聚类"或"聚类分析"按钮
- ❌ 无法触发聚类操作
- ❌ 后端API可能已实现，但前端无法调用
- **影响**: 用户无法使用聚类功能
- **优先级**: P0 - 紧急实现前端功能

**功能详细说明**:

**1. 技术实现**
- 向量化: Sentence Transformers (all-MiniLM-L6-v2)
- 聚类算法: HDBSCAN
- 参数: min_cluster_size=15, min_samples=5（可调）
- 向量缓存: MD5哈希 + pickle缓存

**2. 聚类流程**
1. 读取商品数据
2. 生成文本向量（带缓存）
3. HDBSCAN聚类
4. 更新cluster_id字段
5. 生成簇级汇总

**3. 验收标准**
- [ ] 前端有"开始聚类"按钮或入口
- [ ] 点击后能触发聚类操作
- [ ] 显示聚类进度或状态
- [ ] 能够对10,000条商品进行聚类
- [ ] 聚类时间<5分钟（10,000条）
- [ ] 生成50-100个有意义的簇
- [ ] 噪音比例<25%
- [ ] 簇内商品语义相似度高

---

#### REQ-004: 需求分析（AI辅助）⏳ 待实现

**需求描述**: 使用DeepSeek API分析每个簇的商品，识别满足的用户需求

**功能详细说明**:

**1. 分析流程**
- 对每个聚类簇调用DeepSeek API
- 分析该簇商品满足的用户需求
- 生成需求描述（例如: 项目管理、任务管理、时间管理等）
- 支持批量分析和单个簇分析

**2. API调用**
- 输入: 簇内商品列表（名称）
- Prompt: 分析这些商品满足的用户需求
- 输出: 需求描述（JSON格式）
- 错误处理: API调用失败重试3次

**3. 验收标准**
- [ ] 能够成功调用DeepSeek API
- [ ] 生成的需求描述准确且有价值
- [ ] 单个簇分析时间<10秒
- [ ] 批量分析支持断点续传

---

#### REQ-005: 交付产品识别（AI辅助）⏳ 待实现

**需求描述**: 从商品名称中自动识别交付产品的类型、格式和平台

**功能详细说明**:

**1. 识别内容**
- 交付类型: Excel、PPT、模板、压缩包等
- 具体格式: Excel模板、PPT模板、Notion模板等
- 交付平台: Notion、Canva、Google Sheets等

**2. 实现方式**
- 混合策略: 关键词规则 + AI识别
- 关键词规则: 快速识别常见类型
- AI识别: 处理复杂和模糊情况

**3. 验收标准**
- [ ] 能够准确识别交付产品类型
- [ ] 识别准确率>80%
- [ ] 单个商品识别时间<5秒
- [ ] 批量识别支持断点续传

---

#### REQ-006: 聚类结果展示 ⚠️ 前端未实现

**需求描述**: 以直观的方式展示聚类结果和分析结果

**问题说明** (2026-01-28):
- ❌ 前端界面缺少聚类结果展示
- ❌ 没有"簇概览"或"查看聚类结果"入口
- ❌ 商品列表中看不到 cluster_id（簇ID）字段
- ❌ 无法查看每个簇包含的商品
- ❌ 无法查看簇统计信息
- **影响**: 用户无法查看和分析聚类结果
- **优先级**: P0 - 紧急实现前端功能

**功能详细说明**:

**1. 展示功能**
- 簇概览: 显示所有簇的统计信息
- 簇详情: 查看每个簇包含的商品
- 簇统计: 大小、评分、价格、评价数
- 噪音点展示: 单独展示未聚类的商品
- 搜索筛选: 支持关键词搜索、按大小筛选

**2. 统计信息**
- 簇大小分布
- 评分分布
- 价格分布
- Top 5热门商品

**3. 验收标准**
- [ ] 前端有"查看聚类结果"或"簇概览"入口
- [ ] 能够清晰展示所有簇
- [ ] 能够查看簇详情
- [ ] 商品列表显示 cluster_id 字段
- [ ] 能够按簇ID筛选商品
- [ ] 页面加载时间<2秒
- [ ] 支持筛选和搜索

---

#### REQ-007: 数据导出功能 ✅ 已完成

**需求描述**: 支持导出各阶段的数据结果

**功能详细说明**:

**1. 导出类型**
- 原始商品数据
- 聚类结果（带cluster_id）
- 簇级汇总

**2. 导出格式**
- CSV格式
- Excel格式

**3. 验收标准**
- ✅ 能够导出所有类型的数据
- ✅ 导出时间<30秒（10,000条）
- ✅ 导出的文件格式正确
- ✅ 能够在Excel中正常打开

---

### 数据字段规范

#### 商品表（products）

| 字段名 | 类型 | 必需 | 说明 |
|--------|------|------|------|
| product_id | int | ✅ | 商品ID（主键） |
| product_name | string | ✅ | 商品名称 |
| rating | float | ❌ | 评分（0-5） |
| review_count | int | ❌ | 评价数量 |
| shop_name | string | ❌ | 店铺名称 |
| price | float | ❌ | 价格 |
| cluster_id | int | ❌ | 簇ID |
| delivery_type | string | ❌ | 交付类型 |
| delivery_format | string | ❌ | 交付格式 |
| delivery_platform | string | ❌ | 交付平台 |
| import_time | datetime | ✅ | 导入时间 |
| is_deleted | boolean | ✅ | 是否删除 |

### 当前实现状态

**已完成**: 2/7 P0需求（29%）
- ✅ REQ-001: 数据导入
- ✅ REQ-007: 数据导出

**需要修复**: 3/7 P0需求（43%）
- ⚠️ REQ-002: 数据管理（功能瘫痪）
- ⚠️ REQ-003: 语义聚类（前端未实现）
- ⚠️ REQ-006: 聚类结果展示（前端未实现）

**待实现**: 2/7 P0需求（28%）
- ⏳ REQ-004: 需求分析（AI辅助）
- ⏳ REQ-005: 交付产品识别（AI辅助）

### 核心数据

- **345个商品**（Etsy平台）
- **11个字段**
- **聚类完成率**: 99.1%

---

---

## 🗨️ 模块三：Reddit模块（预留）

### 模块概述

**核心目标**: 从Reddit讨论中挖掘需求

**数据来源**: Reddit平台的subreddit讨论数据

**核心价值**: 用户真实痛点挖掘

**独立性**: 本模块可独立运行，不依赖其他模块

**状态**: 预留，暂不详细设计

---

### 模块工作流程（独立阶段体系）

本模块采用三阶段工作流程：**阶段R1（数据采集）**、**阶段R2（主题聚类）** 和 **阶段R3（需求提取）**

---

#### 📍 阶段R1：数据采集

**目标**: 从Reddit平台采集相关讨论数据

##### R1.1: Subreddit选择
- **状态**: 📝 规划中
- **输入**: 目标领域关键词
- **输出**: 相关subreddit列表
- **功能**:
  - 根据关键词搜索subreddit
  - 分析订阅数、活跃度
  - 筛选高质量subreddit
- **验收标准**:
  - [ ] 每个领域找到5-10个相关subreddit
  - [ ] 订阅数>10,000
  - [ ] 活跃度>100帖/天

##### R1.2: 帖子采集
- **状态**: 📝 规划中
- **输入**: Subreddit列表
- **输出**: 帖子数据集
- **功能**:
  - 采集热门帖子（Top/Hot）
  - 采集评论数据
  - 提取用户痛点
- **验收标准**:
  - [ ] 每个subreddit采集100-500个帖子
  - [ ] 包含标题、内容、评论
  - [ ] 数据完整性>95%

##### R1.3: 数据清洗
- **状态**: 📝 规划中
- **输入**: 原始帖子数据
- **输出**: 清洗后的数据
- **功能**:
  - 去除spam和低质量内容
  - 文本标准化
  - 提取关键信息
- **验收标准**:
  - [ ] 清洗准确率>90%
  - [ ] 保留有价值内容>80%

---

#### 📍 阶段R2：主题聚类

**目标**: 对讨论内容进行主题聚类，发现热门话题

##### R2.1: 文本向量化
- **状态**: 📝 规划中
- **输入**: 清洗后的帖子数据
- **输出**: 文本向量
- **技术**: Sentence Transformers
- **验收标准**:
  - [ ] 向量化时间<5分钟（10,000条）
  - [ ] 向量质量高

##### R2.2: 主题聚类
- **状态**: 📝 规划中
- **输入**: 文本向量
- **输出**: 主题簇
- **算法**: HDBSCAN
- **验收标准**:
  - [ ] 簇数量: 20-50个
  - [ ] 噪音比例: <30%
  - [ ] 主题连贯性: 高

##### R2.3: 主题解释
- **状态**: 📝 规划中
- **输入**: 主题簇
- **输出**: 主题标签和解释
- **方式**: AI辅助
- **验收标准**:
  - [ ] 解释准确率>80%
  - [ ] 每个主题有清晰标签

---

#### 📍 阶段R3：需求提取

**目标**: 从讨论中提取用户痛点和需求

##### R3.1: 痛点识别
- **状态**: 📝 规划中
- **输入**: 主题簇
- **输出**: 用户痛点列表
- **方式**: AI辅助 + 关键词规则
- **验收标准**:
  - [ ] 识别准确率>75%
  - [ ] 每个主题提取3-5个痛点

##### R3.2: 需求分析
- **状态**: 📝 规划中
- **输入**: 痛点列表
- **输出**: 需求分析报告
- **方式**: 5维框架分析
- **验收标准**:
  - [ ] 分析深度: 5维框架完整
  - [ ] 可执行性: 有明确的解决方向

##### R3.3: 机会评估
- **状态**: 📝 规划中
- **输入**: 需求分析报告
- **输出**: 机会评分和优先级
- **评估维度**:
  - 痛点强度
  - 用户规模
  - 现有解决方案
  - 实现难度
- **验收标准**:
  - [ ] 评分合理
  - [ ] 优先级清晰

---

### 当前实现状态

**阶段R1完成度**: 0% (0/3)
- 📝 R1.1: Subreddit选择
- 📝 R1.2: 帖子采集
- 📝 R1.3: 数据清洗

**阶段R2完成度**: 0% (0/3)
- 📝 R2.1: 文本向量化
- 📝 R2.2: 主题聚类
- 📝 R2.3: 主题解释

**阶段R3完成度**: 0% (0/3)
- 📝 R3.1: 痛点识别
- 📝 R3.2: 需求分析
- 📝 R3.3: 机会评估

**模块总完成度**: 0% (0/9)

---

### 数据字段规范

#### Reddit帖子表（reddit_posts）- 预留

| 字段名 | 类型 | 必需 | 说明 |
|--------|------|------|------|
| post_id | string | ✅ | 帖子ID |
| subreddit | string | ✅ | 所属subreddit |
| title | string | ✅ | 帖子标题 |
| content | text | ✅ | 帖子内容 |
| author | string | ❌ | 作者 |
| score | int | ❌ | 评分 |
| num_comments | int | ❌ | 评论数 |
| created_time | datetime | ✅ | 创建时间 |
| cluster_id | int | ❌ | 主题簇ID |
| pain_points | text | ❌ | 识别的痛点 |
| import_time | datetime | ✅ | 导入时间 |

### 预期数据规模

- **Subreddit数量**: 50-100个
- **帖子数量**: 10,000-50,000条
- **主题簇数量**: 20-50个

### 核心原则

1. **真实痛点优先**
   - 关注用户真实讨论
   - 识别高频痛点
   - 验证需求真实性

2. **质量优于数量**
   - 筛选高质量subreddit
   - 过滤spam和低质量内容
   - 保留有价值讨论

3. **AI辅助分析**
   - AI识别痛点
   - 人工验证结果
   - 结合其他模块数据

### 质量指标（预期）

- 📝 数据采集完整性: >95%
- 📝 主题聚类准确率: >80%
- 📝 痛点识别准确率: >75%

---

## 🔗 模块间关联

### 核心价值：多维度需求挖掘

**关联方式**:
- **cluster_id**: 连接关键词和商品
- **source**: 标识数据来源（semrush/reddit/related_search）

**分析场景**:

#### 场景1：发现市场机会
```
1. 词根聚类模块: 发现需求方向（簇#39: 优惠码，318万/月搜索量）
2. 商品管理模块: 查看该方向的商品供给（cluster_id=39）
3. 机会评估: 高需求 + 低供给 = 市场机会
```

#### 场景2：竞品分析
```
1. 搜索关键词"planner"（词根聚类模块）
2. 搜索商品"planner"（商品管理模块）
3. 分析: 评分分布、价格分布、竞品特点
4. 识别: 差异化机会
```

#### 场景3：需求验证
```
1. 从聚类发现需求方向
2. 在Reddit查看用户讨论（预留）
3. 在Etsy查看现有商品
4. 综合评估: 需求真实性和市场机会
```

---

## 📊 数据库架构

### 统一数据库

**数据库**: SQLite（开发）/ PostgreSQL（生产）
**位置**: `data/products.db`

### 数据表结构

**keywords表**（25个字段）:
- 存储关键词和聚类结果
- 支持3种数据源: semrush/reddit/related_search

**cluster_summaries表**（15个字段）:
- 存储簇级汇总信息
- 支持A/B两个阶段

**products表**（11个字段）:
- 存储商品数据和聚类结果
- 支持交付产品识别

---

## 🎯 总体完成度

### 三大模块完成度总览

| 模块 | 阶段体系 | 已完成 | 待实现 | 需要修复 | 完成度 |
|------|---------|--------|--------|----------|--------|
| 模块一：词根聚类 | A/B阶段 (13步) | 3步 | 10步 | 0步 | 23% |
| 模块二：商品管理 | P1-P6阶段 (11步) | 2步 | 8步 | 1步 | 18% |
| 模块三：Reddit | R1/R2/R3阶段 (9步) | 0步 | 9步 | 0步 | 0% |
| **总计** | **33步** | **5步** | **27步** | **1步** | **15%** |

### 各模块独立性说明

**模块一（词根聚类）**:
- ✅ 可独立运行
- ✅ 有独立的数据表（keywords, cluster_summaries）
- ✅ 有独立的API端点（/api/keywords/*）
- ✅ 有独立的阶段体系（A1-A5, B1-B8）

**模块二（商品管理）**:
- ✅ 可独立运行
- ✅ 有独立的数据表（products）
- ✅ 有独立的API端点（/api/products/*）
- ✅ 有独立的阶段体系（P1.1-P1.3, P2.1-P2.2, P3.1-P3.2, P4.1-P4.2, P5.1-P5.3, P6.1）

**模块三（Reddit）**:
- ✅ 可独立运行（设计上）
- 📝 数据表预留（reddit_posts）
- 📝 API端点待开发
- 📝 有独立的阶段体系（R1.1-R1.3, R2.1-R2.3, R3.1-R3.3）

### 模块间协作场景

虽然每个模块可独立运行，但它们可以协同工作：

1. **需求发现 → 供给分析**
   - 模块一发现需求方向 → 模块二分析市场供给

2. **痛点验证 → 需求确认**
   - 模块三发现用户痛点 → 模块一验证搜索需求

3. **三维度综合分析**
   - 搜索需求（模块一）+ 市场供给（模块二）+ 用户痛点（模块三）= 完整市场洞察

---

## 🚀 实施计划（按模块独立规划）

### 模块一：词根聚类模块

#### 阶段A实施计划
- ✅ **A1-A3**: 已完成（种子词准备、短语扩展、语义聚类）
- ⏳ **A4**: 下一步实施（AI簇解释）
- ⏳ **A5**: 后续实施（人工筛选方向）

#### 阶段B实施计划
- ⏳ **B1**: 方向扩展
- 📝 **B2**: 数据清洗（可选）
- ⏳ **B3**: 方向内聚类
- 📝 **B4-B5**: 子簇解释和筛选（可选）
- ⏳ **B6**: 需求分析（5维框架）
- 📝 **B7-B8**: MVP方案和验证计划（可选）

**优先级**: A4 > A5 > B1 > B3 > B6

---

### 模块二：商品管理模块

#### 阶段P1实施计划
- ✅ **P1.1-P1.3**: 已完成（数据导入、管理、导出）

#### 阶段P2实施计划
- ✅ **P2.1-P2.2**: 已完成（语义聚类、结果展示）

#### 阶段P3实施计划
- ⏳ **P3.1**: 下一步实施（需求分析-AI辅助）
- ⏳ **P3.2**: 后续实施（交付产品识别-AI辅助）

**优先级**: P3.1 > P3.2

---

### 模块三：Reddit模块

#### 阶段R1实施计划
- 📝 **R1.1**: Subreddit选择
- 📝 **R1.2**: 帖子采集
- 📝 **R1.3**: 数据清洗

#### 阶段R2实施计划
- 📝 **R2.1**: 文本向量化
- 📝 **R2.2**: 主题聚类
- 📝 **R2.3**: 主题解释

#### 阶段R3实施计划
- 📝 **R3.1**: 痛点识别
- 📝 **R3.2**: 需求分析
- 📝 **R3.3**: 机会评估

**优先级**: 全部预留，暂不实施

---

## 📊 阶段体系对照表

### 旧体系 vs 新体系

| 旧编号 | 旧名称 | 新编号 | 新名称 | 所属模块 |
|--------|--------|--------|--------|----------|
| - | 种子词准备 | A1 | 种子词准备 | 模块一 |
| - | 短语扩展 | A2 | 短语扩展 | 模块一 |
| - | 语义聚类 | A3 | 语义聚类 | 模块一 |
| - | 簇解释 | A4 | 簇解释（AI辅助） | 模块一 |
| - | 人工筛选 | A5 | 人工筛选方向 | 模块一 |
| - | 方向扩展 | B1 | 方向扩展 | 模块一 |
| - | - | B2 | 数据清洗（预留） | 模块一 |
| - | 方向内聚类 | B3 | 方向内聚类 | 模块一 |
| - | - | B4 | 子簇解释（预留） | 模块一 |
| - | - | B5 | 子簇筛选（预留） | 模块一 |
| - | 需求分析 | B6 | 需求分析（5维框架） | 模块一 |
| - | - | B7 | MVP方案设计（预留） | 模块一 |
| - | - | B8 | 验证计划（预留） | 模块一 |
| REQ-001 | 数据导入 | P1.1 | 数据导入功能 | 模块二 |
| REQ-002 | 数据管理 | P1.2 | 数据管理功能 | 模块二 |
| REQ-007 | 数据导出 | P1.3 | 数据导出功能 | 模块二 |
| REQ-003 | 语义聚类 | P2.1 | 语义聚类分析 | 模块二 |
| REQ-006 | 聚类展示 | P2.2 | 聚类结果展示 | 模块二 |
| REQ-004 | 需求分析 | P3.1 | 需求分析（AI辅助） | 模块二 |
| REQ-005 | 交付识别 | P3.2 | 交付产品识别（AI辅助） | 模块二 |
| - | - | R1.1 | Subreddit选择 | 模块三 |
| - | - | R1.2 | 帖子采集 | 模块三 |
| - | - | R1.3 | 数据清洗 | 模块三 |
| - | - | R2.1 | 文本向量化 | 模块三 |
| - | - | R2.2 | 主题聚类 | 模块三 |
| - | - | R2.3 | 主题解释 | 模块三 |
| - | - | R3.1 | 痛点识别 | 模块三 |
| - | - | R3.2 | 需求分析 | 模块三 |
| - | - | R3.3 | 机会评估 | 模块三 |

### 阶段命名规则

- **模块一（词根聚类）**: A1-A5（阶段A）, B1-B8（阶段B）
- **模块二（商品管理）**: P1.1-P1.3（阶段P1）, P2.1-P2.2（阶段P2）, P3.1-P3.2（阶段P3）
- **模块三（Reddit）**: R1.1-R1.3（阶段R1）, R2.1-R2.3（阶段R2）, R3.1-R3.3（阶段R3）

**说明**:
- A/B = 词根聚类的两个主要阶段
- P = Product（商品管理）
- R = Reddit

---

## 🎯 性能指标

### 已达成指标

- ✅ 数据导入时间<30秒（10,000条）
- ✅ 聚类分析时间<5分钟（10,000条）
- ✅ 页面加载时间<2秒
- ✅ API响应时间<1秒

### 质量指标

- ✅ 聚类结果语义连贯性>80%
- ✅ 噪音比例<25%（词根聚类: 3.4%，商品管理: <1%）
- ✅ 数据预处理准确率>99%

---

## 📝 技术约束

### 技术栈

- **前端**: Vue 3 + TypeScript + Element Plus
- **后端**: FastAPI + Python 3.11
- **数据库**: SQLite / PostgreSQL
- **AI**: Claude API / DeepSeek API
- **聚类**: Sentence Transformers + HDBSCAN

### 性能约束

- 支持最多100,000条数据
- 聚类时间<10分钟（100,000条）
- 向量缓存机制提升性能

### 资源约束

- 开发人员: 1人
- 开发周期: 持续迭代

---

## 🔄 需求变更记录

### v4.3 (2026-01-28)
- **变更类型**: 新增需求和优先级规划
- **变更内容**:
  - 新增阶段P4：聚类增强（2个需求）
    - P4.1: 类别名称生成（AI）🟠 P1
    - P4.2: 复杂筛选功能 🟡 P2
  - 新增阶段P5：商品属性提取（3个需求）
    - P5.1: 商品属性提取（代码规则）🟢 P3
    - P5.2: Top商品AI深度分析 🔵 P4
    - P5.3: AI辅助兜底 🟣 P5
  - 新增阶段P6：数据可视化（1个需求）
    - P6.1: 数据可视化 ⚪ P6
  - 更新数据库字段规范：
    - products表新增：cluster_name, delivery_type, key_keywords, user_need
    - cluster_summaries表新增：cluster_name, common_delivery_type, user_need
  - 明确实施优先级：P0（修复瘫痪功能）→ P1（类别名）→ P2（复杂筛选）→ P3-P6
  - 调整模块二完成度：29% → 18%（新增需求后）
  - 调整总体完成度：17% → 15%（新增需求后）
- **变更原因**:
  - 用户需求讨论后明确了聚类结果展现方式
  - 确定了成本优化策略（代码规则 + AI辅助）
  - 规划了完整的实施路径
- **实施策略**:
  - 优先修复现有功能（P0）
  - 然后增强聚类可读性（P1-P2）
  - 再提取商品属性（P3-P5）
  - 最后完善可视化（P6）
- **成本预估**: 总计 $2-4（AI调用）

### v4.2 (2026-01-28)
- **变更类型**: 更新现有功能状态
- **变更内容**:
  - 将 P2.1 语义聚类分析状态从"✅ 已完成"改为"⚠️ 前端未实现"
  - 将 P2.2 聚类结果展示状态从"✅ 已完成"改为"⚠️ 前端未实现"
  - 添加详细问题说明：前端界面缺少聚类功能入口和展示
  - 更新验收标准，明确需要实现的前端功能
  - 调整模块二完成度：57% → 29%
  - 调整阶段P2完成度：100% → 0%
  - 调整总体完成度：24% → 17%
- **变更原因**: 前端界面完全缺少聚类相关功能，用户无法使用和查看聚类结果
- **优先级**: P0 - 紧急实现前端功能
- **用户反馈**: 用户需要完全理解聚类的数据和逻辑

### v4.1 (2026-01-28)
- **变更类型**: 更新现有功能状态
- **变更内容**:
  - 将 P1.2 数据管理功能状态从"✅ 已完成"改为"⚠️ 需要修复"
  - 添加详细问题说明：排序、筛选、翻页、搜索功能不可用
  - 更新验收标准，明确需要修复的功能点
  - 调整模块二完成度：71% → 57%
  - 调整总体完成度：28% → 24%
- **变更原因**: 商品管理页面核心功能瘫痪，无法正常使用
- **优先级**: P0 - 紧急修复

### v4.0 (2026-01-28)
- **重大更新**: 整合所有阶段体系到3个模块下
- 为每个模块设计独立的阶段体系
- 模块一: A/B阶段体系（13步）
- 模块二: P1/P2/P3阶段体系（7步）
- 模块三: R1/R2/R3阶段体系（9步）
- 创建阶段体系对照表（旧编号 vs 新编号）
- 明确各模块独立性和协作场景
- 更新实施计划（按模块独立规划）

### v3.0 (2026-01-27)
- 整合所有需求文档
- 明确三大模块架构
- 统一字段命名规范
- 更新实施计划

### v2.0 (2026-01-27)
- 项目重构
- 聚焦商品管理模块
- 定义7个核心功能
- 预留长尾词和Reddit模块

### v1.0 (2025-12-15)
- 初始版本
- 定义词根聚类流程

---

## 📞 文档维护

**主要文档**:
- 本文档: `docs/需求文档.md`（统一需求文档）
- API文档: `docs/API使用示例.md`
- 使用手册: `docs/使用手册.md`
- 快速开始: `docs/04_快速开始指南.md`

**文档更新原则**:
1. 所有需求变更必须更新本文档
2. 保持文档与代码实现同步
3. 记录变更历史

---

*文档创建者: Claude Sonnet 4.5*
*最后更新: 2026-01-28*
