# 需求挖掘系统 - 统一需求文档

**项目名称**: 需求挖掘系统 (Demand Mining System)
**文档版本**: v3.0
**创建日期**: 2026-01-27
**最后更新**: 2026-01-27

---

## 📋 项目概述

### 项目定位

基于多数据源的需求挖掘与分析平台，通过语义聚类和AI分析，从海量数据中发现产品机会方向。

### 核心理念

**从数据 → 聚类 → 需求 → 产品验证**

### 目标用户

- 产品经理
- 需求分析师
- 市场研究人员
- 创业者（个人使用）

### 系统架构

```
需求挖掘系统 v2.0
├── 模块一：词根聚类模块（长尾词分析）
├── 模块二：商品管理模块（Etsy商品分析）
└── 模块三：Reddit模块（预留）
```

---

## 🎯 模块一：词根聚类模块（长尾词分析）

### 模块概述

**核心目标**: 从英文单词种子发现产品机会方向

**数据来源**: SEMrush / Reddit / Related Search

**核心流程**: 单词 → 短语 → 语义簇 → 需求方向 → MVP验证

### 完整工作流程

#### 阶段A：种子词扩展与聚类

**A1: 种子词准备**
- **输入**: 46个英文单词种子
- **示例**: compress, convert, generate, track, optimize
- **输出**: 种子词列表

**A2: 短语扩展**
- **输入**: 种子词列表
- **方式**: SEMrush / Reddit / Related Search（影刀RPA自动采集）
- **输出**: `merged_keywords_all.csv`（1000-5000条短语）
- **字段**: keyword, seed_word, seed_group, source, volume, intent等

**A3: 语义聚类** ✅ 已实现
- **输入**: `merged_keywords_all.csv`
- **算法**: Sentence Transformers (all-MiniLM-L6-v2) + HDBSCAN
- **参数**: min_cluster_size=15, min_samples=3（可调）
- **输出**:
  - `stageA_clusters.csv`（短语级，带cluster_id_A）
  - `cluster_summary_A3.csv`（簇级汇总）
- **目标**: 60-100个语义簇，噪音比例<25%

**A4: 簇解释（AI辅助）** ⏳ 待实现
- **输入**: `cluster_summary_A3.csv`
- **方式**: Claude API / DeepSeek API
- **输出**: 每个簇的语义解释和核心主题
- **字段**: cluster_label, cluster_explanation

**A5: 人工筛选方向** ⏳ 待实现
- **输入**: `cluster_summary_A3.csv`（带AI解释）
- **方式**: 人工审查 + Trends验证
- **输出**: `direction_keywords.csv`（5-10个方向）
- **字段**: direction_keyword, from_cluster_id_A, priority等

#### 阶段B：方向深化与需求分析

**B1: 方向扩展** ⏳ 待实现
- **输入**: `direction_keywords.csv`
- **方式**: SEMrush / Reddit（针对每个方向再次扩展）
- **输出**: 每个方向扩展500-2000条短语
- **文件**: `raw_phrases_stageB.csv`

**B3: 方向内聚类** ⏳ 待实现
- **输入**: 方向扩展结果
- **算法**: HDBSCAN（每个方向内部再聚类）
- **输出**: `stageB_clusters.csv`（方向内的子簇，10-30个）
- **字段**: cluster_id_B, direction_keyword等

**B6: 需求分析（5维框架）** ⏳ 待实现
- **输入**: 方向内子簇
- **方式**: Claude API + 5维框架分析
- **5维框架**:
  1. What - 用户要做什么
  2. Why - 为什么要做
  3. Who - 什么人群
  4. When - 什么场景
  5. How - 如何解决
- **输出**: 需求分析报告

### 当前实现状态

**已完成**:
- ✅ A2: 数据导入（6,565个关键词）
- ✅ A3: 语义聚类（63个簇，噪音3.4%）
- ✅ 聚类结果展示
- ✅ 数据导出

**待实现**:
- ⏳ A4: AI簇解释
- ⏳ A5: 人工筛选 + Trends验证
- ⏳ B1: 方向扩展
- ⏳ B3: 方向内聚类
- ⏳ B6: 需求分析

### 数据字段规范

#### 短语级字段（stageA_clusters.csv）

| 字段名 | 类型 | 必需 | 说明 |
|--------|------|------|------|
| keyword | string | ✅ | 短语内容 |
| seed_word | string | ✅ | 来源种子词 |
| seed_group | string | ✅ | 种子词分组 |
| source | string | ✅ | 数据来源（semrush/reddit/related_search） |
| volume | int | ⏳ | 月搜索量 |
| intent | string | ⏳ | 搜索意图 |
| cluster_id_a | int | ✅ | 簇ID（-1表示噪音） |
| cluster_size | int | ✅ | 簇大小 |
| is_noise | bool | ✅ | 是否噪音点 |
| word_count | int | ✅ | 单词数 |
| phrase_length | int | ✅ | 字符长度 |

#### 簇级字段（cluster_summary_A3.csv）

| 字段名 | 类型 | 必需 | 说明 |
|--------|------|------|------|
| cluster_id | int | ✅ | 簇ID |
| stage | string | ✅ | 阶段标识（A/B） |
| cluster_size | int | ✅ | 簇大小 |
| seed_words_in_cluster | string | ✅ | 簇内种子词列表 |
| top_keywords | string | ✅ | 代表性短语（前5个） |
| example_phrases | string | ✅ | 示例短语 |
| cluster_label | string | ⏳ | 簇标签（AI生成） |
| cluster_explanation | string | ⏳ | 簇解释（AI生成） |
| avg_volume | int | ⏳ | 平均搜索量 |
| total_volume | int | ⏳ | 总搜索量 |

### 核心原则

1. **只分组，不删除**
   - 聚类只分组，不过滤
   - 噪音点保留，人工决定是否使用
   - 筛选标记low priority，不删除

2. **轻量版起步**
   - Phase 1: A2 → A3 → 人工筛选
   - Phase 2: B1 → B3 → B6
   - Phase 3: 大模型 + Trends + 需求库

3. **大模型输出是假设**
   - A4的簇解释需要SERP验证
   - B6的5维框架需要访谈验证
   - 决策优先级: SERP+访谈 > BI > 经验 > 模型

### 质量指标

- ✅ 簇数量: 60-100个（当前63个）
- ✅ 噪音比例: <25%（当前3.4%）
- ✅ 聚类覆盖率: >95%（当前96.6%）
- ✅ 语义连贯性: 高（同簇关键词语义相关）

---

## 🛍️ 模块二：商品管理模块（Etsy商品分析）

### 模块概述

**核心目标**: 分析市场供给情况，识别交付产品类型

**数据来源**: Etsy平台

**核心价值**: 需求-供给匹配分析

### P0需求清单（7个核心功能）

#### REQ-001: 数据导入功能 ✅ 已完成

**需求描述**: 支持从Excel/CSV文件导入Etsy商品数据

**功能详细说明**:

**1. 输入格式**
- 文件格式: Excel (.xlsx, .xls) 或 CSV (.csv)
- 文件结构: **无表头**（第一行就是数据）
- 固定5列结构:
  - 列0: 商品名称 (product_name) - 必填
  - 列1: 评分 (rating) - 可选，0-5
  - 列2: 评价数量 (review_count) - 可选，带括号和单位
  - 列3: 店铺名称 (shop_name) - 可选
  - 列4: 价格 (price) - 可选

**2. 数据预处理**

**评价数量转换规则**:
```
(1.1k) → 1100
(19.1k) → 19100
(9.8k) → 9800
(15) → 15
(2.5m) → 2500000
```

**处理步骤**:
1. 去除括号: (1.1k) → 1.1k
2. 识别单位: k/K → ×1000, m/M → ×1000000
3. 转换为整数

**其他清洗**:
- 去除所有字段的前后空格
- 价格去除货币符号（$、€等）
- 缺失值标记为NULL
- 评分验证范围（0-5）

**3. 验收标准**
- ✅ 能够成功上传Excel和CSV文件
- ✅ 能够正确解析无表头的5列数据
- ✅ 能够正确转换评价数量
- ✅ 能够处理10,000+条商品数据
- ✅ 导入时间<30秒（10,000条）
- ✅ 数据预处理准确率>99%

---

#### REQ-002: 数据管理功能 ✅ 已完成

**需求描述**: 对导入的商品数据进行查看、编辑、删除等基本管理操作

**功能详细说明**:

**1. 查询功能**
- 商品列表展示（分页，每页50条）
- 全文搜索（商品名称）
- 多条件筛选:
  - 评分范围 (min_rating, max_rating)
  - 价格范围 (min_price, max_price)
  - 店铺名称
  - 簇ID (cluster_id)
- 多字段排序

**2. 编辑功能**
- 单条编辑: 更新商品信息
- 批量删除: 软删除（标记is_deleted=true）

**3. 验收标准**
- ✅ 能够流畅展示10,000+条数据
- ✅ 搜索响应时间<1秒
- ✅ 能够正确筛选和排序
- ✅ 能够成功编辑和保存
- ✅ 能够批量删除数据

---

#### REQ-003: 语义聚类分析 ✅ 已完成

**需求描述**: 基于商品名称进行语义聚类，自动分组相似商品

**功能详细说明**:

**1. 技术实现**
- 向量化: Sentence Transformers (all-MiniLM-L6-v2)
- 聚类算法: HDBSCAN
- 参数: min_cluster_size=15, min_samples=5（可调）
- 向量缓存: MD5哈希 + pickle缓存

**2. 聚类流程**
1. 读取商品数据
2. 生成文本向量（带缓存）
3. HDBSCAN聚类
4. 更新cluster_id字段
5. 生成簇级汇总

**3. 验收标准**
- ✅ 能够对10,000条商品进行聚类
- ✅ 聚类时间<5分钟（10,000条）
- ✅ 生成50-100个有意义的簇
- ✅ 噪音比例<25%
- ✅ 簇内商品语义相似度高

---

#### REQ-004: 需求分析（AI辅助）⏳ 待实现

**需求描述**: 使用DeepSeek API分析每个簇的商品，识别满足的用户需求

**功能详细说明**:

**1. 分析流程**
- 对每个聚类簇调用DeepSeek API
- 分析该簇商品满足的用户需求
- 生成需求描述（例如: 项目管理、任务管理、时间管理等）
- 支持批量分析和单个簇分析

**2. API调用**
- 输入: 簇内商品列表（名称）
- Prompt: 分析这些商品满足的用户需求
- 输出: 需求描述（JSON格式）
- 错误处理: API调用失败重试3次

**3. 验收标准**
- [ ] 能够成功调用DeepSeek API
- [ ] 生成的需求描述准确且有价值
- [ ] 单个簇分析时间<10秒
- [ ] 批量分析支持断点续传

---

#### REQ-005: 交付产品识别（AI辅助）⏳ 待实现

**需求描述**: 从商品名称中自动识别交付产品的类型、格式和平台

**功能详细说明**:

**1. 识别内容**
- 交付类型: Excel、PPT、模板、压缩包等
- 具体格式: Excel模板、PPT模板、Notion模板等
- 交付平台: Notion、Canva、Google Sheets等

**2. 实现方式**
- 混合策略: 关键词规则 + AI识别
- 关键词规则: 快速识别常见类型
- AI识别: 处理复杂和模糊情况

**3. 验收标准**
- [ ] 能够准确识别交付产品类型
- [ ] 识别准确率>80%
- [ ] 单个商品识别时间<5秒
- [ ] 批量识别支持断点续传

---

#### REQ-006: 聚类结果展示 ✅ 已完成

**需求描述**: 以直观的方式展示聚类结果和分析结果

**功能详细说明**:

**1. 展示功能**
- 簇概览: 显示所有簇的统计信息
- 簇详情: 查看每个簇包含的商品
- 簇统计: 大小、评分、价格、评价数
- 噪音点展示: 单独展示未聚类的商品
- 搜索筛选: 支持关键词搜索、按大小筛选

**2. 统计信息**
- 簇大小分布
- 评分分布
- 价格分布
- Top 5热门商品

**3. 验收标准**
- ✅ 能够清晰展示所有簇
- ✅ 能够查看簇详情
- ✅ 页面加载时间<2秒
- ✅ 支持筛选和搜索

---

#### REQ-007: 数据导出功能 ✅ 已完成

**需求描述**: 支持导出各阶段的数据结果

**功能详细说明**:

**1. 导出类型**
- 原始商品数据
- 聚类结果（带cluster_id）
- 簇级汇总

**2. 导出格式**
- CSV格式
- Excel格式

**3. 验收标准**
- ✅ 能够导出所有类型的数据
- ✅ 导出时间<30秒（10,000条）
- ✅ 导出的文件格式正确
- ✅ 能够在Excel中正常打开

---

### 数据字段规范

#### 商品表（products）

| 字段名 | 类型 | 必需 | 说明 |
|--------|------|------|------|
| product_id | int | ✅ | 商品ID（主键） |
| product_name | string | ✅ | 商品名称 |
| rating | float | ❌ | 评分（0-5） |
| review_count | int | ❌ | 评价数量 |
| shop_name | string | ❌ | 店铺名称 |
| price | float | ❌ | 价格 |
| cluster_id | int | ❌ | 簇ID |
| delivery_type | string | ❌ | 交付类型 |
| delivery_format | string | ❌ | 交付格式 |
| delivery_platform | string | ❌ | 交付平台 |
| import_time | datetime | ✅ | 导入时间 |
| is_deleted | boolean | ✅ | 是否删除 |

### 当前实现状态

**已完成**: 5/7 P0需求（71%）
- ✅ REQ-001: 数据导入
- ✅ REQ-002: 数据管理
- ✅ REQ-003: 语义聚类
- ✅ REQ-006: 聚类结果展示
- ✅ REQ-007: 数据导出

**待实现**: 2/7 P0需求（29%）
- ⏳ REQ-004: 需求分析（AI辅助）
- ⏳ REQ-005: 交付产品识别（AI辅助）

### 核心数据

- **345个商品**（Etsy平台）
- **11个字段**
- **聚类完成率**: 99.1%

---

## 🗨️ 模块三：Reddit模块（预留）

### 模块概述

**核心目标**: 从Reddit讨论中挖掘需求

**数据来源**: Reddit平台的subreddit讨论数据

**状态**: 预留，暂不详细设计

### 预期功能

**数据采集**:
- Subreddit订阅数
- 讨论主题
- 热门帖子
- 用户痛点

**数据分析**:
- 主题聚类
- 痛点识别
- 需求提取

### 当前状态

- ✅ 数据结构已定义（keyword表的source字段支持reddit）
- ✅ 测试数据已准备（test_reddit_data.csv）
- ⏳ 功能未实现

---

## 🔗 模块间关联

### 核心价值：多维度需求挖掘

**关联方式**:
- **cluster_id**: 连接关键词和商品
- **source**: 标识数据来源（semrush/reddit/related_search）

**分析场景**:

#### 场景1：发现市场机会
```
1. 词根聚类模块: 发现需求方向（簇#39: 优惠码，318万/月搜索量）
2. 商品管理模块: 查看该方向的商品供给（cluster_id=39）
3. 机会评估: 高需求 + 低供给 = 市场机会
```

#### 场景2：竞品分析
```
1. 搜索关键词"planner"（词根聚类模块）
2. 搜索商品"planner"（商品管理模块）
3. 分析: 评分分布、价格分布、竞品特点
4. 识别: 差异化机会
```

#### 场景3：需求验证
```
1. 从聚类发现需求方向
2. 在Reddit查看用户讨论（预留）
3. 在Etsy查看现有商品
4. 综合评估: 需求真实性和市场机会
```

---

## 📊 数据库架构

### 统一数据库

**数据库**: SQLite（开发）/ PostgreSQL（生产）
**位置**: `data/products.db`

### 数据表结构

**keywords表**（25个字段）:
- 存储关键词和聚类结果
- 支持3种数据源: semrush/reddit/related_search

**cluster_summaries表**（15个字段）:
- 存储簇级汇总信息
- 支持A/B两个阶段

**products表**（11个字段）:
- 存储商品数据和聚类结果
- 支持交付产品识别

---

## 🎯 成功标准

### 功能完整性

**词根聚类模块**:
- ✅ A3聚类已实现
- ⏳ A4/A5/B系列待实现
- 完成度: 40%

**商品管理模块**:
- ✅ 5/7 P0需求已实现
- ⏳ 2/7 P0需求待实现
- 完成度: 71%

**Reddit模块**:
- ⏳ 完全预留
- 完成度: 0%

**总体完成度**: 约50%

### 性能指标

- ✅ 数据导入时间<30秒（10,000条）
- ✅ 聚类分析时间<5分钟（10,000条）
- ✅ 页面加载时间<2秒
- ✅ API响应时间<1秒

### 质量指标

- ✅ 聚类结果语义连贯性>80%
- ✅ 噪音比例<25%（词根聚类: 3.4%）
- ✅ 数据预处理准确率>99%

---

## 🚀 实施计划

### Phase 1: 基础功能（已完成）✅

**词根聚类模块**:
- ✅ A2: 数据导入
- ✅ A3: 语义聚类
- ✅ 聚类结果展示

**商品管理模块**:
- ✅ REQ-001: 数据导入
- ✅ REQ-002: 数据管理
- ✅ REQ-007: 数据导出

### Phase 2: 核心分析（已完成）✅

**词根聚类模块**:
- ✅ 聚类质量优化
- ✅ 数据导出

**商品管理模块**:
- ✅ REQ-003: 语义聚类
- ✅ REQ-006: 聚类结果展示

### Phase 3: AI增强（进行中）⏳

**词根聚类模块**:
- ⏳ A4: AI簇解释
- ⏳ A5: 人工筛选 + Trends验证
- ⏳ B1-B6: 方向深化分析

**商品管理模块**:
- ⏳ REQ-004: 需求分析（AI辅助）
- ⏳ REQ-005: 交付产品识别（AI辅助）

### Phase 4: 模块扩展（规划中）📝

**Reddit模块**:
- 📝 数据采集
- 📝 主题聚类
- 📝 需求提取

---

## 📝 技术约束

### 技术栈

- **前端**: Vue 3 + TypeScript + Element Plus
- **后端**: FastAPI + Python 3.11
- **数据库**: SQLite / PostgreSQL
- **AI**: Claude API / DeepSeek API
- **聚类**: Sentence Transformers + HDBSCAN

### 性能约束

- 支持最多100,000条数据
- 聚类时间<10分钟（100,000条）
- 向量缓存机制提升性能

### 资源约束

- 开发人员: 1人
- 开发周期: 持续迭代

---

## 🔄 需求变更记录

### v3.0 (2026-01-27)
- 整合所有需求文档
- 明确三大模块架构
- 统一字段命名规范
- 更新实施计划

### v2.0 (2026-01-27)
- 项目重构
- 聚焦商品管理模块
- 定义7个核心功能
- 预留长尾词和Reddit模块

### v1.0 (2025-12-15)
- 初始版本
- 定义词根聚类流程

---

## 📞 文档维护

**主要文档**:
- 本文档: `docs/需求文档.md`（统一需求文档）
- API文档: `docs/API使用示例.md`
- 使用手册: `docs/使用手册.md`
- 快速开始: `docs/04_快速开始指南.md`

**文档更新原则**:
1. 所有需求变更必须更新本文档
2. 保持文档与代码实现同步
3. 记录变更历史

---

*文档创建者: Claude Sonnet 4.5*
*最后更新: 2026-01-27*
