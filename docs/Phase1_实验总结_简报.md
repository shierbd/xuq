# Phase 1 实验总结 - 简报

**日期**: 2026-02-02
**状态**: ✅ 已完成

---

## 🎯 核心发现

> **Metric 不是主要问题，Method 有帮助但效果有限。真正的问题在于预处理策略（属性词污染）和 Stage 2/3 的设计（制造微簇）。**

---

## 📊 实验结果一览

| 实验 | 改动 | 簇数变化 | 噪音变化 | 效果 |
|------|------|---------|---------|------|
| **基线** | euclidean + leaf | 1,412 | 4,620 (29.26%) | - |
| **实验 1** | + L2 归一化 (cosine) | +4 (+0.28%) | +25 (+0.54%) | ❌ 无效果 |
| **实验 2** | + Stage 1 eom | -24 (-1.7%) | -172 (-3.7%) | ⚠️ 小幅改善 |
| **累积** | 两项优化 | **-20 (-1.4%)** | **-147 (-3.2%)** | ⚠️ 效果有限 |

---

## 🔍 关键洞察

### 1. Metric 不是主要问题 ❌
- L2 归一化（cosine-equivalent）几乎无效果（< 1%）
- 说明 Sentence Transformers 的向量可能已接近归一化
- **结论**: 不要期待 metric 能解决问题

### 2. EOM 有帮助但不是银弹 ⚠️
- Stage 1 用 eom 有小幅改善（-1.7% 簇数，-3.7% 噪音）
- 但微型簇仍然很多（719 个，占 51.6%）
- **结论**: EOM 是正确方向，但单独使用效果有限

### 3. 微型簇问题的根源 🎯
```
微型簇 (3-4 个商品): 719 个
占总簇数: 51.6%
占总商品数: ~2,500 个 (15.8%)
```

**根源**:
1. **Stage 2/3 仍在制造微簇** - 为了减少噪音而牺牲质量
2. **属性词污染** - 颜色/材质/风格词导致按属性聚类
3. **参数设置问题** - min_cluster_size 太小（3-5）

### 4. 真正的问题在哪里 🔴

**重新排序后的优先级**:

| 问题 | GPT 优先级 | 实验验证 | 实际优先级 |
|------|-----------|---------|-----------|
| Metric (euclidean) | P0 | ❌ 无效果 | **P2** ⬇️ |
| Method (leaf) | P0 | ⚠️ 小幅改善 | **P1** ➡️ |
| Epsilon (0.3) | P0 | ✅ 已关闭 | **P0** ✅ |
| **预处理策略** | P0 | ❓ 未测试 | **P0** ⬆️ |
| **Stage 2/3 设计** | - | ❓ 未测试 | **P0** 🆕 |

---

## 🚀 下一步行动

### P0 - 必须立即执行

#### 1. 实验 3: 双文本策略 🔴 **最高优先级**

**目标**: 去除颜色/材质/风格词，按需求主题聚类

**实施**:
```python
def preprocess_text(self, text: str) -> Tuple[str, str]:
    """
    返回:
        topic_text: 去除属性词，用于聚类
        full_text: 保留完整信息，用于展示
    """
```

**预期效果**:
- 簇按需求主题分组（不按颜色/材质）
- 簇更容易命名和理解
- 可能大幅减少簇数量
- **这可能是最关键的改进**

---

#### 2. 重新设计 Stage 2/3 🔴

**目标**: 不再制造微簇，而是归并和质量控制

**Stage 2 新策略**: 归并到最近主题簇
```python
stage2_labels = self.merge_noise_to_clusters(
    embeddings, stage1_labels, threshold=0.75
)
```

**Stage 3 新策略**: 小簇聚类 + 质量门控
```python
stage3_labels = self.filter_low_quality_clusters(
    stage3_labels,
    min_internal_similarity=0.6,
    min_keyword_distinctiveness=0.3
)
```

**预期效果**:
- 微簇数量大幅减少
- 只保留高质量、可命名的簇
- 噪音可能增加，但主题质量提升

---

### P1 - 可选优化

3. **提高 min_cluster_size**: 10→15, 5→8, 3→5
4. **Stage 2/3 也改用 eom**: 进一步减少微簇

---

## 📈 预期效果

### 当前状态
```
簇数: 1,392
  - 主要簇 (≥10): 215 (15.4%)
  - 次级簇 (5-9): 458 (32.9%)
  - 微型簇 (3-4): 719 (51.6%) ⚠️
噪音: 4,473 (28.32%)
```

### 目标状态（实施 P0 优化后）
```
簇数: 300-500 ⬇️
  - 主要簇 (≥10): 200-300 (60-80%) ⬆️
  - 次级簇 (5-9): 80-150 (20-30%)
  - 微型簇 (3-4): 20-50 (5-10%) ⬇️
噪音: 30-40% ⬆️ (可接受)
可命名簇比例: >80% ⬆️
```

**核心目标**: 宁可少而准，不要多而脏

---

## 📚 详细文档

1. **Phase1_实验总结报告.md** - 完整分析（91KB）
2. **实验1_cosine_metric结果.md** - 实验 1 详细数据
3. **实验2_eom_vs_leaf结果.md** - 实验 2 详细数据
4. **聚类优化行动计划.md** - 完整行动计划

---

## 🎓 经验教训

1. **不要盲目相信理论预期** - 必须通过实验验证
2. **问题的根源可能不在算法** - 数据质量 > 算法优化
3. **覆盖率 vs 质量的权衡** - 宁可少而准，不要多而脏
4. **快速实验的价值** - 1 天验证方向 > 1 周完美计划

---

## ✅ 已完成

- ✅ 实验 1: Cosine vs Euclidean Metric
- ✅ 实验 2: EOM vs Leaf for Stage 1
- ✅ 生成详细实验报告
- ✅ 提交所有文档到 git
- ✅ 验证优化方向

---

## 🔜 下一阶段

**Phase 2: P0 问题修复**

1. 实验 3: 双文本策略（2-3 天）
2. 重新设计 Stage 2/3（3-5 天）
3. 质量评估（1-2 天）

**预计完成**: 1 周内

---

**创建者**: Claude Sonnet 4.5
**最后更新**: 2026-02-02
