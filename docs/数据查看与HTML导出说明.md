# 数据查看与HTML导出功能说明

## 📋 功能概述

为了解决英文数据阅读困难的问题，系统新增了**数据查看与管理**页面，支持将所有数据导出为HTML格式，方便使用浏览器的翻译功能。

---

## 🎯 主要功能

### 1. 集中数据查看

在Web UI侧边栏选择 **"📋 数据查看与管理"**，可以查看以下5种数据类型：

- **大组聚类 (Clusters Level A)** - Phase 2生成的大组聚类
- **小组聚类 (Clusters Level B)** - Phase 4生成的小组聚类
- **需求卡片 (Demands)** - Phase 4生成的需求卡片
- **关键词 (Tokens)** - Phase 5提取的关键词
- **短语 (Phrases)** - 原始短语数据（采样显示）

### 2. 在线筛选功能

每种数据类型都提供了相应的筛选选项：

**大组聚类筛选**：
- 仅显示已选中的聚类
- 按最小大小筛选（例如：只显示size >= 50的大组）

**需求卡片筛选**：
- 按类型筛选（tool/content/service/education/other）
- 按商业价值筛选（high/medium/low/unknown）
- 按状态筛选（idea/validated/in_progress/archived）

**Token筛选**：
- 按类型筛选（intent/action/object/other）
- 按最小频次筛选

### 3. HTML导出功能 ⭐核心功能

每种数据类型都提供**"📤 导出为HTML"**按钮，点击后会：

1. 生成独立的HTML文件
2. 保存到 `data/output/` 目录
3. 包含完整的样式（CSS）和数据
4. 在浏览器中可以直接打开和翻译

导出的文件：
- `clusters_view.html` - 聚类数据
- `demands_view.html` - 需求卡片（卡片式布局）
- `tokens_view.html` - Token数据（按类型分组）

### 4. 下载功能

每个HTML文件生成后，会显示**"⬇️ 下载HTML"**按钮，可以直接下载到本地。

---

## 💡 如何使用浏览器翻译

### 方法1: Chrome浏览器

1. 打开导出的HTML文件（双击或拖入浏览器）
2. 右键点击页面任意位置
3. 选择 **"翻译为中文"**
4. 或者点击地址栏右侧的翻译图标 🌐

### 方法2: Edge浏览器

1. 打开导出的HTML文件
2. 右键点击页面
3. 选择 **"翻译"**
4. 选择目标语言为"中文"

### 方法3: Firefox浏览器

Firefox需要先安装翻译插件：
1. 安装"Google Translate"或其他翻译插件
2. 打开HTML文件
3. 使用插件的翻译功能

---

## 📊 HTML文件特性

### 美化的样式

所有HTML文件都包含：
- 清晰的表格/卡片布局
- 颜色标识（例如：高商业价值用绿色背景）
- 响应式设计（适配各种屏幕）
- 易读的字体和间距

### 独立运行

- 所有CSS样式嵌入在HTML中
- 不需要网络连接
- 可以离线查看
- 可以分享给其他人

### 翻译友好

- 使用标准HTML标签
- 文本内容清晰分离
- 浏览器翻译效果良好

---

## 🎬 完整使用流程

### 场景1: 查看和翻译大组聚类

```
1. 访问Web UI: http://localhost:8501
2. 点击侧边栏 "📋 数据查看与管理"
3. 选择数据类型: "大组聚类 (Clusters Level A)"
4. 勾选筛选条件（可选）：
   - ✅ 仅显示已选中
   - 最小大小: 30
5. 点击 "📤 导出为HTML"
6. 看到成功提示：✅ 已导出到: D:\xiangmu\...\clusters_view.html
7. 在浏览器中打开该文件
8. 右键 → "翻译为中文"
9. 阅读翻译后的聚类主题和示例短语
```

### 场景2: 查看和翻译需求卡片

```
1. 访问Web UI
2. 进入 "📋 数据查看与管理"
3. 选择 "需求卡片 (Demands)"
4. 设置筛选条件（可选）：
   - 类型: tool, content
   - 商业价值: high, medium
   - 状态: validated
5. 在页面上查看前10个需求卡片（Streamlit显示）
6. 点击 "📤 导出为HTML" 导出全部筛选结果
7. 在浏览器中打开 demands_view.html
8. 右键翻译，阅读完整的需求描述和用户场景
```

### 场景3: 查看Token词库

```
1. 进入 "📋 数据查看与管理"
2. 选择 "关键词 (Tokens)"
3. 筛选：
   - Token类型: intent, action
   - 最小频次: 5
4. 查看按类型分组的tokens
5. 导出为HTML并翻译
6. 了解每个token的含义和使用频次
```

---

## 📁 文件位置

所有导出的HTML文件保存在：

```
data/output/
├── clusters_view.html      # 聚类数据
├── demands_view.html       # 需求卡片
└── tokens_view.html        # Token数据
```

你可以：
- 在浏览器中直接打开
- 复制到其他位置
- 通过邮件分享
- 打印为PDF（浏览器打印功能）

---

## ⚠️ 注意事项

### 1. 数据量大时

对于短语数据（Phrases），由于数据量可能有5万+条，系统只提供采样显示：
- 默认采样1000条
- 可以调整采样数量（100-10000）
- 不支持全量导出（会太大）

### 2. 筛选条件

- 导出的HTML只包含**当前筛选后的数据**
- 如果没有筛选，会导出所有数据
- 建议先筛选，再导出，减少文件大小

### 3. 翻译质量

- 浏览器自动翻译的质量取决于翻译服务（Google Translate/Microsoft Translator）
- 专业术语可能翻译不准确
- 可以在原文和译文之间切换查看

---

## 🔄 与Phase 3的关系

**Phase 3: 聚类筛选** 也提供了HTML导出功能，但有所不同：

| 功能 | Phase 3 | 数据查看与管理 |
|------|---------|----------------|
| 用途 | 人工打分筛选 | 查看和翻译数据 |
| 导出数据 | 大组聚类 | 5种数据类型 |
| 筛选功能 | 有限 | 丰富的筛选选项 |
| CSV编辑 | 支持导入编辑后的CSV | 不支持（只读） |
| 适用场景 | Phase 3人工筛选阶段 | 任何时候查看数据 |

**建议**：
- Phase 3阶段：使用Phase 3页面的导出功能进行人工打分
- 其他时候：使用"数据查看与管理"页面查看和翻译数据

---

## 📚 相关文档

- [WEB_UI_README.md](../WEB_UI_README.md) - Web UI完整使用说明
- [USER_GUIDE.md](USER_GUIDE.md) - 系统使用指南
- [Phase4_Implementation_Summary.md](Phase4_Implementation_Summary.md) - 需求卡片说明

---

## 💬 常见问题

### Q1: 为什么有些数据显示"(无)"或"No title"？

**答**: 这些数据可能是：
- 还没有运行LLM生成（例如：main_theme需要Phase 3的--ai-theme参数）
- 使用了--skip-llm参数（跳过了LLM调用）
- 数据本身没有填写

**解决方法**：
- 重新运行对应的Phase，不使用--skip-llm
- 或者手动编辑CSV后导入

### Q2: 导出的HTML文件在哪里？

**答**: 默认位置是 `data/output/` 目录：
```
D:\xiangmu\词根聚类需求挖掘\data\output\
```

你可以：
- 在文件资源管理器中打开该目录
- 在Streamlit界面中看到完整路径
- 使用"下载HTML"按钮直接下载

### Q3: 可以导出为其他格式吗（Excel/PDF）？

**答**: 当前版本只支持HTML导出，因为：
- HTML可以在任何浏览器打开
- 支持原生翻译功能
- 不需要额外软件

如果需要Excel格式：
- 可以从HTML复制粘贴到Excel
- 或者直接查询数据库导出CSV

如果需要PDF格式：
- 在浏览器中打开HTML
- 使用"打印"功能
- 选择"另存为PDF"

### Q4: 翻译后能保存吗？

**答**: 浏览器翻译是实时的，不会保存到文件。如果需要保存翻译后的版本：

**方法1**: 打印为PDF
```
1. 右键翻译页面
2. Ctrl+P 打印
3. 选择"另存为PDF"
4. 保存翻译后的PDF
```

**方法2**: 复制到Word
```
1. 翻译页面
2. Ctrl+A 全选
3. Ctrl+C 复制
4. 粘贴到Word文档
5. 保存
```

### Q5: 数据更新后需要重新导出吗？

**答**: 是的。HTML文件是静态的，包含导出时的数据快照。如果数据库数据更新了（例如重新运行Phase 4），需要：
1. 回到"数据查看与管理"页面
2. 重新点击"导出为HTML"
3. 生成新的HTML文件（会覆盖旧文件）

---

## 🎉 总结

**数据查看与管理**页面是专门为不懂英语的用户设计的功能，核心优势：

✅ **一键导出HTML** - 无需编辑CSV
✅ **浏览器翻译** - Chrome/Edge右键即可翻译
✅ **美观易读** - 清晰的布局和样式
✅ **离线使用** - 不需要网络连接
✅ **灵活筛选** - 只导出需要的数据

**使用建议**：
1. 运行完每个Phase后，进入"数据查看与管理"查看结果
2. 使用筛选功能减少数据量
3. 导出为HTML并在浏览器中翻译
4. 根据翻译结果决定下一步操作（例如：Phase 3选择哪些聚类）

---

**祝使用愉快！** 🚀
