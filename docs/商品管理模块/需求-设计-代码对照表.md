# 商品管理模块 需求-设计-代码对照表

**生成日期**: 2026-02-04
**范围**: 商品管理模块（Etsy商品分析），含 P1-P7 需求与实现映射

---

## 1. 需求-设计-代码追踪矩阵

| 需求/阶段 | 需求摘要 | 需求设计/说明 | 后端实现 | 前端实现 | 备注/状态 |
|---|---|---|---|---|---|
| REQ-001 / P1.1 | 数据导入（Excel/CSV，无表头5列，预处理） | `docs/需求文档.md:300`, `docs/商品管理模块/02-P1-数据管理阶段.md:26` | `backend/routers/products.py:15`, `backend/services/import_service.py:18`, `backend/utils/data_preprocessor.py:9`, `backend/models/product.py:19` | `frontend/src/pages/products/DataImport.jsx:33`, `frontend/src/api/import_export.js:9` | 已实现 |
| REQ-002 / P1.2 | 数据管理（列表/搜索/筛选/排序/编辑/删除） | `docs/需求文档.md:326`, `docs/商品管理模块/02-P1-数据管理阶段.md:249` | `backend/services/product_service.py:17`, `backend/routers/products.py:326`, `backend/schemas/product_schema.py:21`, `backend/routers/products.py:727`, `backend/routers/products.py:744` | `frontend/src/pages/products/ProductManagement.jsx:724`, `frontend/src/components/ProductTable.jsx:44` | 已实现 |
| REQ-007 / P1.3 | 数据导出（原始/聚类/汇总，CSV/Excel） | `docs/需求文档.md:356`, `docs/商品管理模块/02-P1-数据管理阶段.md:611` | `backend/services/export_service.py:17`, `backend/routers/products.py:786` | `frontend/src/pages/products/DataExport.jsx:24`, `frontend/src/api/import_export.js:28` | 已对齐导出接口 |
| REQ-003 / P2.1 | 语义聚类（商品名聚类） | `docs/需求文档.md:377`, `docs/商品管理模块/聚类功能实现说明.md:15` | `backend/services/clustering_service.py:1494`, `backend/routers/products.py:880` | `frontend/src/pages/products/ProductManagement.jsx:98` | 已实现 |
| REQ-006 / P2.2 | 聚类结果展示 | `docs/需求文档.md:409` | `backend/services/cluster_view_service.py:17`, `backend/routers/products.py:1024`, `backend/routers/products.py:993` | `frontend/src/components/ClusterOverview.jsx:1` | 已实现 |
| REQ-004 / P3.1 | 需求分析（AI） | `docs/需求文档.md:447`, `docs/商品管理模块/04-P3-AI增强阶段.md:25` | `backend/services/demand_analysis_service.py:14`, `backend/routers/demand_analysis.py:26` | `frontend/src/api/demand_analysis.js:19`, `frontend/src/pages/products/ProductManagement.jsx:136` | 已实现 |
| REQ-005 / P3.2 | 交付产品识别（规则+AI） | `docs/需求文档.md:493`, `docs/商品管理模块/04-P3-AI增强阶段.md:25` | `backend/services/delivery_identification_service.py:15`, `backend/routers/delivery_identification.py:23` | `frontend/src/api/delivery_identification.js:16`, `frontend/src/pages/products/ProductManagement.jsx:285` | 已实现 |
| REQ-008 / P4.1 | 类别名称生成/中文翻译 | `docs/需求文档.md:530`, `docs/翻译功能测试报告.md:1` | `backend/models/product.py:31`, `backend/migrations/add_cluster_name_cn.py:13`, `backend/scripts/translate_cluster_names.py:1`, `backend/schemas/product_schema.py:34` | `frontend/src/components/ProductTable.jsx:88`, `frontend/src/components/ClusterOverview.jsx:57` | 已实现 |
| REQ-009 / P4.2 | 复杂筛选 | `docs/需求文档.md:559` | `backend/services/product_service.py:39`, `backend/routers/products.py:326` | `frontend/src/pages/products/ProductManagement.jsx:618` | 已实现 |
| REQ-010 / P5.1 | 属性提取（规则） | `docs/需求文档.md:593` | `backend/services/attribute_extraction_service.py:15`, `backend/routers/attribute_extraction.py:26` | `frontend/src/api/attribute_extraction.js:14`, `frontend/src/pages/products/ProductManagement.jsx:322` | 已实现 |
| REQ-011 / P5.2 | Top 商品 AI 深度分析 | `docs/需求文档.md:643` | `backend/services/top_product_analysis_service.py:14`, `backend/routers/top_product_analysis.py:16` | `frontend/src/api/top_product_analysis.js:12`, `frontend/src/pages/products/ProductManagement.jsx:356` | 已实现 |
| REQ-012 / P5.3 | AI 辅助兜底（补全交付形式） | `docs/需求文档.md:675` | `backend/services/attribute_extraction_service.py:62`, `backend/routers/attribute_extraction.py:97` | `frontend/src/api/attribute_extraction.js:36`, `frontend/src/pages/products/ProductManagement.jsx:388` | 已实现 |
| REQ-013 / P6.1 | 数据可视化 | `docs/需求文档.md:706` | `backend/routers/products.py:201` | `frontend/src/components/ProductVisualization.jsx:1`, `frontend/src/pages/products/ProductManagement.jsx:744` | 已实现 |
| P-EXT / 关键词 | 簇关键词/词根提取与落库（TF-IDF/词形归一） | — | `backend/services/product_keyword_service.py:1`, `backend/models/product_cluster_keyword.py:1`, `backend/routers/products.py:1002` | — | 新增 |
| P-EXT / 任务进度 | 聚类/关键词异步任务与进度查询 | — | `backend/services/task_manager.py:1`, `backend/routers/tasks.py:1`, `backend/routers/products.py:980` | — | 新增 |
| P7.1 | 双文本策略（topic_text） | `docs/需求文档.md:742`, `PROJECT_COMPLETION_SUMMARY.md:52` | `backend/models/product.py:35`, `backend/services/clustering_service.py:1267` | — | 已实现（后端支持） |
| P7.2 | 层级需求结构 | `docs/需求文档.md:780` | 未找到实现 | 未找到实现 | 需求存在，代码未落地 |
| P7.3 | Stage 2/3 归并策略 + 质量门控 | `docs/需求文档.md:817`, `PROJECT_COMPLETION_SUMMARY.md:72` | `backend/services/clustering_service.py:902`, `backend/services/clustering_service.py:1061`, `backend/services/clustering_service.py:1185` | — | 已实现（后端支持） |

---

## 2. 数据模型与字段（商品表）

- 数据模型：`backend/models/product.py:9`
- 关键字段：`product_name`, `rating`, `review_count`, `shop_name`, `price`, `cluster_id`, `cluster_name`, `cluster_name_cn`, `topic_text`, `delivery_type`, `delivery_format`, `delivery_platform`, `user_need`, `import_time`, `is_deleted`（见 `backend/models/product.py:17`）
- API Schema：`backend/schemas/product_schema.py:9`

---

## 3. 发现的缺口与不一致

1) **文档索引缺失**：
- `docs/商品管理模块/README.md:17` 列出了 P2/P4-P6/技术实现/使用指南等文档，但当前目录未找到：
  - `03-P2-聚类分析阶段.md`
  - `05-P4-聚类增强阶段.md`
  - `06-P5-属性提取阶段.md`
  - `07-P6-数据可视化阶段.md`
  - `08-技术实现与API文档.md`
  - `09-使用指南与最佳实践.md`

2) **已对齐项（本轮修正）**：
- 导出接口与后端导出路由对齐（`frontend/src/api/import_export.js:28` ↔ `backend/routers/products.py:786`）
- 批量删除请求体统一为 `{"product_ids": [...]}`（`frontend/src/api/products.js:37` ↔ `backend/routers/products.py:765`）
- 表格字段与 `Product` 模型已对齐（`frontend/src/components/ProductTable.jsx:44`）
- 前端已补齐编辑/删除入口（`frontend/src/pages/products/ProductManagement.jsx:724`, `frontend/src/components/ProductTable.jsx:44`）

---

## 4. 额外实现（非需求文档REQ编号）

- 批量导入文件夹：`backend/routers/batch_import.py:12`, `frontend/src/pages/products/BatchImport.jsx:1`
- 聚类质量报告：`backend/routers/products.py:1008`

---

如需我继续补齐缺失文档或对齐前后端接口/字段，请告诉我优先级顺序。
