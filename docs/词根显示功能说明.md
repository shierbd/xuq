# Phase 0 词根显示功能说明

## 功能概述

在分词结果中新增了**原始词根追踪**功能，用户可以：
1. 查看每个分词词汇来源于哪些原始词根（seed_word）
2. 筛选排除本身是词根的词汇，专注于分词后的新词
3. 导出时包含词根信息，便于后续扩词

## 新增列说明

### 1. 原始词根列
- **含义**：显示该词汇是从哪些关键词（phrases）中分出来的，而那些关键词对应的原始词根（seed_word）
- **格式**：多个词根用逗号分隔（如：`calculator, compute`）
- **示例**：
  ```
  | 词汇      | 频次 | 原始词根     |
  |-----------|------|--------------|
  | online    | 50   | calculator   |
  | calculator| 100  | calculator   |
  | tool      | 80   | calculator   |
  ```

### 2. 词根数量列
- **含义**：该词对应的唯一原始词根数量
- **用途**：快速判断该词的来源复杂度
- **示例**：
  - `calculator: 1` - 只来源于1个词根
  - `best: 3` - 来源于3个不同词根（如calculator, phone, laptop）

## 筛选功能

### 排除本身是词根的词
- **位置**：高级筛选 → 词根筛选 → "排除本身是词根的词"
- **原理**：判断一个词是否为词根的方法是检查它的原始词根集合中是否包含自己
- **使用场景**：
  - 当您已经知道原始词根是什么时，可以排除它们
  - 专注于查看分词后的新词汇
  - 减少选择量，提高筛选效率

- **示例**：
  ```
  假设您的原始词根是 "calculator"，关键词有：
  - "best calculator tool"
  - "online calculator"
  - "calculator app"

  分词后：calculator, best, tool, online, app

  勾选"排除本身是词根的词"后，只显示：
  - best, tool, online, app
  ```

## 使用流程

### 典型工作流程

1. **Phase 1: 数据导入**
   - 导入初始关键词CSV
   - 确保填写了 `seed_word` 字段

2. **Phase 0: 分词与筛选**
   - 加载数据库关键词
   - 点击"开始分词"（会自动追踪词根信息）
   - 查看分词结果，包含"原始词根"和"词根数量"列

3. **高级筛选**
   - 频次筛选：选择频次范围
   - 词性筛选：选择名词、动词等
   - **词根筛选**：勾选"排除本身是词根的词"

4. **词汇选择与导出**
   - 使用复选框选择感兴趣的词汇
   - 导出CSV/HTML（包含原始词根信息）
   - 使用导出的词汇进行二次扩词

5. **重复迭代**
   - 使用选中的词去外部工具扩词
   - 再次导入（设置正确的seed_word）
   - 重复步骤2-4

## 技术实现

### 数据结构

```python
# 分词时记录词根映射
word_to_seeds = {
    'calculator': {'calculator'},
    'online': {'calculator'},
    'tool': {'calculator', 'software'},  # 可能来自多个词根
    'best': {'calculator', 'phone'},
}
```

### 判断是否为词根

```python
def is_seed_word(word, word_to_seeds):
    """判断一个词是否为原始词根"""
    seeds = word_to_seeds.get(word, set())
    return word in seeds

# 示例
is_seed_word('calculator', word_to_seeds)  # True（词根）
is_seed_word('online', word_to_seeds)      # False（分词词汇）
```

## 导出数据格式

导出的CSV包含以下列：

| 列名 | 说明 |
|------|------|
| 词汇 | 分词后的词 |
| 频次 | 出现次数 |
| 词性 | 详细词性标签（如NN, VB） |
| 词性分类 | 简化分类（名词、动词等） |
| 中文 | 中文翻译（可选） |
| **原始词根** | **该词来源的seed_word** |
| **词根数量** | **唯一词根数** |

## 注意事项

1. **数据要求**
   - 导入数据时必须填写 `seed_word` 字段
   - 如果没有seed_word，会标记为 "unknown"

2. **缓存机制**
   - 首次加载后，数据会缓存在内存中
   - 如需重新加载，点击"🔄 重新加载"按钮

3. **词根判断逻辑**
   - 一个词可能对应多个词根（当它在多个不同词根的关键词中出现）
   - 只有当词根集合中包含自己时，才认为它是原始词根

## 实际应用示例

### 场景：扩展"calculator"相关关键词

**第1轮：初始导入**
```csv
phrase,seed_word
calculator,calculator
scientific calculator,calculator
online calculator,calculator
```

**分词结果**：
| 词汇 | 频次 | 原始词根 | 词根数量 |
|------|------|----------|----------|
| calculator | 3 | calculator | 1 |
| scientific | 1 | calculator | 1 |
| online | 1 | calculator | 1 |

**筛选操作**：
- 勾选"排除本身是词根的词" → 只显示 scientific, online
- 选择这些词并导出

**第2轮：扩词后再导入**
```csv
phrase,seed_word
scientific research,scientific
scientific method,scientific
online shopping,online
online learning,online
```

**分词结果**（累计）：
| 词汇 | 频次 | 原始词根 | 词根数量 |
|------|------|----------|----------|
| scientific | 3 | calculator, scientific | 2 |
| online | 3 | calculator, online | 2 |
| research | 1 | scientific | 1 |
| method | 1 | scientific | 1 |
| shopping | 1 | online | 1 |
| learning | 1 | online | 1 |

这样可以清楚看到词汇的扩展路径！

## 总结

通过词根追溯功能，您可以：
- ✅ 了解每个词的来源
- ✅ 识别哪些是原始词根，哪些是分词词汇
- ✅ 快速筛选排除已知词根
- ✅ 追踪扩词的迭代路径
- ✅ 评估哪些词根扩展效果最好
